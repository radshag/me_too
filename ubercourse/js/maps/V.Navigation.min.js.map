{"version":3,"sources":["V.Navigation.js"],"names":["initNavigation","V","Navigation","go","next","prev","lock","unlock","isLocked","showGate","hideGate","openGate","blink","stopBlink","closePeripherals","setOrder","Audio","play","playAudio","stop","stopAudio","pause","pauseAudio","mute","muteAudio","unmute","unmuteAudio","disable","disableAudio","enable","enableAudio","body","document","gateText","querySelector","currentPageElement","currentPageId","currentParentId","currentParentElement","currentTimelineId","tl","targetPageElement","targetPageId","targetParentElement","targetParentId","isTimelinesActive","Timelines","isActive","audioEnabled","audioNowPlaying","audioTimeout","audioId","audioFiles","isMuted","SCORM","get","pageNavigationOrder","Array","from","getElementsByClassName","page","id","pageList","CustomEase","create","initMuteButton","classList","add","initNavigateOnKeydown","options","Element","contains","console","warn","trDur","transitionDuration","Pages","parent","children","isNewPageValid","onLeave","element","audio","transition","callOnEnter","updateSCORM","updatePeripherals","hasInnerPages","innerPageIds","navigateToInnerPage","log","error","openChildPage","openNewPage","style","display","opacity","fadeIn","scrollToTop","endCurrentTimeline","fadeOut","fadeOutChild","zIndex","currentLabel","isTargetInTimeline","startNewTimeline","visibility","tweenWithinTimeline","fadeInChild","kill","pagesSelector","undefined","$pages","TweenLite","selector","needsRebuild","build","setTimeout","bind","labelNames","currentLabelIndex","indexOf","idLabelIndex","reverse","tweenTo","fadeInDeferred","set","fromTo","overwrite","autoAlpha","fadeOutDeferred","delay","to","documentElement","scrollTop","autoCSS","Menu","getList","render","updateGate","isConnected","updateAddressBar","onEnter","setLocation","setViewed","hasGate","innerHTML","getCompleted","remove","newURL","currentURLmatches","window","location","href","match","restOfURL","split","replace","history","pushState","info","isGateClosed","findNextPage","onNext","siblings","index","length","nextPage","findPrevPage","prevPage","addEventListener","gateKeydown","removeEventListener","isUnlocked","onGate","setGateText","text","setCompleted","event","keyCode","preventDefault","stopPropagation","blinkTL","TimelineMax","paused","repeat","nextArrow","querySelectorAll","blinkSpeed","ease","Sine","easeInOut","clearProps","close","resumeAudio","hidden","getAudio","file","volume","currentTime","filePath","substr","onComplete","ended","Expo","easeIn","matchMedia","matches","Project","config","hasAudio","muteButton","getElementById","throttledNext","_","throttle","throttledPrev","navigateOnKeydown","isUserTyping","open"],"mappings":";;;;;;;;;;4OAAA,CAAC,CAAC,QAASA,eAAT,CAAwBC,CAAxB,CAA2B,CAC3BA,EAAEC,UAAF,CAAe,CACbC,KADa,CAEbC,SAFa,CAGbC,SAHa,CAIbC,SAJa,CAKbC,aALa,CAMbC,QANa,oBAMF,CAAC,MAAOA,UAAP,CAAiB,CANhB,CAObC,iBAPa,CAQbC,iBARa,CASbC,iBATa,CAUbC,WAVa,CAWbC,mBAXa,CAYbC,iCAZa,CAabC,iBAba,CAAf,CAgBAd,EAAEe,KAAF,CAAU,CACRC,KAAMC,SADE,CAERC,KAAMC,SAFE,CAGRC,MAAOC,UAHC,CAIRC,KAAMC,SAJE,CAKRC,OAAQC,WALA,CAMRC,QAASC,YAND,CAORC,OAAQC,WAPA,CAAV,CAWA,GAAMC,MAAOC,SAASD,IAAtB,CACA,GAAME,UAAWD,SAASE,aAAT,CAAuB,aAAvB,CAAjB,CAGA,GAAIC,0BAAJ,CACA,GAAIC,qBAAJ,CACA,GAAIC,uBAAJ,CACA,GAAIC,4BAAJ,CACA,GAAIC,yBAAJ,CACA,GAAIC,UAAJ,CACA,GAAIC,yBAAJ,CACA,GAAIC,oBAAJ,CACA,GAAIC,2BAAJ,CACA,GAAIC,sBAAJ,CACA,GAAIC,mBAAoB5C,EAAE6C,SAAF,EAAe7C,EAAE6C,SAAF,CAAYC,QAAnD,CAGA,GAAIvC,WAAW,KAAf,CAEA,QAASF,KAAT,EAAgB,CACdE,UAAW,IAAX,CACD,CAED,QAASD,OAAT,EAAkB,CAChBC,UAAW,KAAX,CACD,CAGD,GAAIwC,cAAelB,aAAnB,CACA,GAAImB,uBAAJ,CACA,GAAIC,oBAAJ,CACA,GAAIC,eAAJ,CACA,GAAIC,YAAa,EAAjB,CACA,GAAIC,SAAU,CAAC,CAACpD,EAAEqD,KAAF,CAAQC,GAAR,CAAY,MAAZ,CAAhB,CAGA,GAAIC,qBAAsBC,MAAMC,IAAN,CACxB1B,SAAS2B,sBAAT,CAAgC,MAAhC,CADwB,CAExB,SAACC,IAAD,QAAUA,MAAKC,EAAf,EAFwB,CAA1B,CAKA,QAAS9C,SAAT,CAAkB+C,QAAlB,CAA4B,CAC1BN,oBAAsBM,QAAtB,CACD,CAED,GAAId,YAAJ,CAAkB,CAChBe,WAAWC,MAAX,CAAkB,cAAlB,CAAkC,uBAAlC,EACAC,iBACD,CAHD,IAGO,CACLjC,SAASD,IAAT,CAAcmC,SAAd,CAAwBC,GAAxB,CAA4B,iBAA5B,EACD,CAEDC,wBAUA,QAASjE,GAAT,CAAY0D,EAAZ,CAAgBQ,OAAhB,CAAyB,CACvBA,QAAUA,SAAW,EAArB,CAGA,GAAI,OAAOR,GAAP,mCAAOA,EAAP,KAAc,QAAlB,CAA4B,CAC1BQ,QAAUR,EAAV,CACD,CAGD,GAAI,MAAOA,GAAP,GAAc,QAAlB,CAA4B,CAE1BnB,aAAemB,EAAf,CACD,CAHD,IAGO,IAAIA,aAAcS,QAAd,EAAyBT,GAAGK,SAAH,CAAaK,QAAb,CAAsB,MAAtB,CAA7B,CAA4D,CAEjE7B,aAAemB,GAAGA,EAAlB,CACD,CAHM,IAGA,IAAIQ,QAAQR,EAAZ,CAAgB,CAErBnB,aAAe2B,QAAQR,EAAvB,CACD,CAGD,GAAI,CAACnB,YAAL,CAAmB,CACjB8B,QAAQC,IAAR,kDACD,CAED,GAAMC,OAAQL,QAAQM,kBAAR,EAA8B,GAA5C,CAGA,GAAI/B,gBAAiB3C,EAAE2E,KAAF,CAAQlC,YAAR,GAAyBzC,EAAE2E,KAAF,CAAQlC,YAAR,EAAsBmC,MAApE,CAGA,GAAI5E,EAAE2E,KAAF,CAAQlC,YAAR,GAAyBzC,EAAE2E,KAAF,CAAQlC,YAAR,EAAsBoC,QAAnD,CAA6D,CAC3DlC,eAAiBF,YAAjB,CACAA,aAAezC,EAAE2E,KAAF,CAAQlC,YAAR,EAAsBoC,QAAtB,CAA+B,CAA/B,CAAf,CACD,CAED,GAAI,CAACC,gBAAL,CAAuB,CACrB,MAAO,MAAP,CACD,CAGD,GACE3C,eACGnC,EAAE2E,KAAF,CAAQxC,aAAR,EAAuB4C,OAD1B,EAEG/E,EAAE2E,KAAF,CAAQxC,aAAR,EAAuB4C,OAAvB,CAA+BtC,YAA/B,IAAiD,KAHtD,CAIE,CACA,MAAO,MAAP,CACD,CAGDD,kBAAqBxC,EAAE2E,KAAF,CAAQlC,YAAR,EAAsBuC,OAA3C,CACArC,eAAkB3C,EAAE2E,KAAF,CAAQlC,YAAR,EAAsBmC,MAAxC,CACAlC,oBAAuBC,eAAiB3C,EAAE2E,KAAF,CAAQhC,cAAR,EAAwBqC,OAAzC,CAAmD,IAA1E,CAGA,GAAI7C,aAAJ,CAAmB,CACjBD,mBAAqBlC,EAAE2E,KAAF,CAAQxC,aAAR,EAAuB6C,OAA5C,CACA5C,gBAAkBpC,EAAE2E,KAAF,CAAQxC,aAAR,EAAuByC,MAAzC,CACAvC,qBAAuBD,gBAAkBpC,EAAE2E,KAAF,CAAQvC,eAAR,EAAyB4C,OAA3C,CAAqD,IAA5E,CACD,CAGDnE,mBAGA,GAAIkC,YAAJ,CAAkB,CAChB9B,UAAUjB,EAAE2E,KAAF,CAAQlC,YAAR,EAAsBwC,KAAhC,EACD,CAGDC,aAGAC,cACAC,cACAC,oBAEAlD,cAAgBM,YAAhB,CACAP,mBAAqBM,iBAArB,CACAJ,gBAAkBO,cAAlB,CACAN,qBAAuBK,mBAAvB,CAEA,GAAI1C,EAAE2E,KAAF,CAAQxC,aAAR,EAAuBmD,aAAvB,EAAwC,CAACC,YAA7C,CAA2D,CACzDC,oBAAoB,CAApB,EACD,CAED,MAAO,KAAP,CAOA,QAASV,eAAT,EAAyB,CACvB,GACE,CAACnC,cAAD,EACGR,aADH,EAEGM,eAAiBzC,EAAE2E,KAAF,CAAQxC,aAAR,EAAuByC,MAH7C,CAIE,CACAL,QAAQkB,GAAR,CAAY,GAAZ,CAAiBhD,YAAjB,CAA+B,uCAA/B,CAAwEN,aAAxE,CAAuF,GAAvF,EACA,MAAO,MAAP,CACD,CAGD,GAAI,CAACnC,EAAE2E,KAAF,CAAQlC,YAAR,CAAL,CAA4B,CAC1B8B,QAAQmB,KAAR,CAAc,UAAd,CAA0BjD,YAA1B,CAAwC,4CAAxC,EACA,MAAO,MAAP,CACD,CAGD,GAAI,CAACzC,EAAE2E,KAAF,CAAQlC,YAAR,EAAsBuC,OAA3B,CAAoC,CAClCT,QAAQmB,KAAR,CAAc,2BAAd,CAA2CjD,YAA3C,CAAyD,kCAAzD,EACA,MAAO,MAAP,CACD,CAID,GAAIA,eAAiBN,aAArB,CAAoC,CAClCoC,QAAQkB,GAAR,CAAY,oBAAZ,CAAkChD,YAAlC,CAAgD,oCAAhD,EACA,MAAO,MAAP,CACD,CAED,MAAO,KAAP,CACD,CAKD,QAASyC,WAAT,EAAsB,CACpB,GAAIvC,cAAJ,CAAoB,CAClBgD,gBACD,CAFD,IAEO,CACLC,cACD,CACF,CAED,QAASA,YAAT,EAAuB,CACrB,GAAIV,YAAad,QAAQc,UAAR,EAAsB,MAAvC,CAEA,GAAI,CAAChD,kBAAL,CAAyB,CAEvB,GAAIgD,aAAe,MAAnB,CAA2B,CACzB1C,kBAAkBqD,KAAlB,CAAwBC,OAAxB,CAAkC,OAAlC,CACAtD,kBAAkBqD,KAAlB,CAAwBE,OAAxB,CAAkC,CAAlC,CACD,CAHD,IAGO,CACLC,OAAOxD,iBAAP,EACD,CACF,CARD,IAQO,CACLyD,cAEA,GAAI3D,iBAAJ,CAAuB,CACrB4D,qBACD,CAED,GAAIhB,YAAc,MAAlB,CAA0B,CACxBc,OAAOxD,iBAAP,EACA,GAAIJ,eAAJ,CAAqB,CACnB+D,QAAQ9D,oBAAR,EACA+D,aAAalE,kBAAb,EACD,CAHD,IAGO,CACLiE,QAAQjE,kBAAR,EACD,CACF,CARD,IAQO,CACLM,kBAAkBqD,KAAlB,CAAwBQ,MAAxB,CAAiC,CAAjC,CACA7D,kBAAkBqD,KAAlB,CAAwBC,OAAxB,CAAkC,OAAlC,CACA5D,mBAAmB2D,KAAnB,CAAyBQ,MAAzB,CAAkC,CAAlC,CACAnE,mBAAmB2D,KAAnB,CAAyBC,OAAzB,CAAmC,MAAnC,CACD,CACF,CACF,CAED,QAASH,cAAT,EAAyB,CACvB,GAAIpD,EAAJ,CAAQgC,QAAQkB,GAAR,CAAY,SAAZ,CAAuBlD,GAAG+D,YAAH,EAAvB,EAER,GAAIpB,YAAad,QAAQc,UAAR,EAAsB,MAAvC,CAEA,GAAI,CAAChD,kBAAL,CAAyB,CAGvB,GAAIqE,oBAAJ,CAA0B,CACxBC,mBACA9D,oBAAoBmD,KAApB,CAA0BC,OAA1B,CAAoC,OAApC,CACApD,oBAAoBmD,KAApB,CAA0BE,OAA1B,CAAoC,CAApC,CACD,CAJD,IAIO,CACLrD,oBAAoBmD,KAApB,CAA0BC,OAA1B,CAAoC,OAApC,CACApD,oBAAoBmD,KAApB,CAA0BE,OAA1B,CAAoC,CAApC,CACAvD,kBAAkBqD,KAAlB,CAAwBY,UAAxB,CAAqC,SAArC,CACAjE,kBAAkBqD,KAAlB,CAAwBE,OAAxB,CAAkC,CAAlC,CACD,CACF,CAbD,IAaO,CACLE,cAEA,GAAIf,YAAc,MAAlB,CAA0B,CACxB,GAAI9C,kBAAoBO,cAAxB,CAAwC,CAEtC,GAAI4D,oBAAJ,CAA0B,CACxBG,sBACD,CAFD,IAEO,CACLC,YAAYnE,iBAAZ,EACA4D,aAAalE,kBAAb,EACD,CACF,CARD,IAQO,IAAIE,eAAJ,CAAqB,CAE1B,GAAImE,oBAAJ,CAA0B,CACxBL,qBACAM,mBACD,CAHD,IAGO,CACLR,OAAOtD,mBAAP,EACAiE,YAAYnE,iBAAZ,EACA2D,QAAQ9D,oBAAR,EACA+D,aAAalE,kBAAb,EACD,CACF,CAXM,IAWA,CAEL,GAAIqE,oBAAJ,CAA0B,CACxBC,mBACD,CAFD,IAEO,CACLG,YAAYnE,iBAAZ,EACD,CAEDwD,OAAOtD,mBAAP,EACAyD,QAAQjE,kBAAR,EACD,CACF,CA/BD,IA+BO,CACLQ,oBAAoBmD,KAApB,CAA0BQ,MAA1B,CAAmC,CAAnC,CACA3D,oBAAoBmD,KAApB,CAA0BC,OAA1B,CAAoC,OAApC,CACAtD,kBAAkBqD,KAAlB,CAAwBQ,MAAxB,CAAiC,CAAjC,CACA7D,kBAAkBqD,KAAlB,CAAwBC,OAAxB,CAAkC,SAAlC,CACA5D,mBAAmB2D,KAAnB,CAAyBQ,MAAzB,CAAkC,CAAlC,CACAnE,mBAAmB2D,KAAnB,CAAyBC,OAAzB,CAAmC,MAAnC,CACD,CACF,CAGD1D,gBAAkBO,cAAlB,CACAN,qBAAuBK,mBAAvB,CACD,CAGD,QAAS6D,mBAAT,EAA8B,CAC5B,MAAO3D,oBAAqB5C,EAAE6C,SAAF,CAAYF,cAAZ,CAA5B,CACD,CAGD,QAASuD,mBAAT,EAA8B,CAE5BlG,EAAE6C,SAAF,CAAYP,iBAAZ,EAA+BsE,IAA/B,GAGAT,QAAQnG,EAAE6C,SAAF,CAAYP,iBAAZ,EAA+BuE,aAAvC,EAGAvE,kBAAoBwE,SAApB,CACD,CAED,QAASN,iBAAT,EAA4B,CAC1BlE,kBAAoBK,cAApB,CACAJ,GAAKvC,EAAE6C,SAAF,CAAYP,iBAAZ,CAAL,CAEA,GAAIyE,QAASC,UAAUC,QAAV,CAAmB1E,GAAGsE,aAAtB,CAAb,CAEA,GAAItE,GAAG2E,YAAP,CAAqB,CACnB3E,GAAG4E,KAAH,GACAnH,EAAE6C,SAAF,CAAYP,iBAAZ,EAA+B4E,YAA/B,CAA8C,KAA9C,CACD,CAEDE,WAAW7E,GAAGvB,IAAH,CAAQqG,IAAR,CAAa9E,EAAb,CAAiBE,YAAjB,CAAX,CAA2C,CAA3C,EAED,CAED,QAASiE,oBAAT,EAA+B,CAE7B,GAAInE,GAAG+E,UAAP,CAAmB,CACjB,GAAIC,mBAAoBhF,GAAG+E,UAAH,CAAcE,OAAd,CAAsBjF,GAAG+D,YAAH,EAAtB,CAAxB,CACA,GAAImB,cAAelF,GAAG+E,UAAH,CAAcE,OAAd,CAAsB/E,YAAtB,CAAnB,CAEA,GAAI8E,kBAAoB,CAApB,EAAyBE,YAAzB,EAAyCA,aAAe,CAA5D,CAA+D,CAE7DlF,GAAGmF,OAAH,CAAWH,iBAAX,EACD,CAHD,IAGO,IAAIA,kBAAoB,CAApB,EAAyBE,YAA7B,CAA2C,CAEhDlF,GAAGvB,IAAH,CAAQyB,YAAR,EACD,CAHM,IAGA,CAELF,GAAGoF,OAAH,CAAWpF,GAAG+E,UAAH,CAAcG,aAAe,CAA7B,CAAX,EACD,CACF,CAdD,IAcO,CACLlF,GAAGvB,IAAH,CAAQyB,YAAR,EACD,CACF,CAED,QAASuD,OAAT,CAAgBiB,QAAhB,CAA0B,CACxBG,WAAW,QAASQ,eAAT,EAA0B,CACnCZ,UAAUa,GAAV,CACEZ,QADF,CAEE,CAACZ,OAAQ,CAAT,CAFF,EAKAW,UAAUc,MAAV,CACEb,QADF,CAEExC,KAFF,CAGE,CACEsB,QAAS,CADX,CAHF,CAME,CACEA,QAAS,CADX,CAEED,QAAS,OAFX,CAGEiC,UAAW,KAHb,CANF,EAYD,CAlBD,CAkBG,CAlBH,EAmBD,CAED,QAASpB,YAAT,CAAqBM,QAArB,CAA+B,CAC7BG,WAAW,QAASQ,eAAT,EAA0B,CACnCZ,UAAUa,GAAV,CACEZ,QADF,CAEE,CAACZ,OAAQ,CAAT,CAFF,EAKAW,UAAUc,MAAV,CACEb,QADF,CAEE,CAFF,CAGE,CACEe,UAAW,CADb,CAHF,CAME,CACEA,UAAW,CADb,CAEED,UAAW,KAFb,CANF,EAWD,CAjBD,CAiBG,CAjBH,EAkBD,CAED,QAAS5B,QAAT,CAAiBc,QAAjB,CAA2B,CACzBG,WAAW,QAASa,gBAAT,EAA2B,CACpCjB,UAAUa,GAAV,CACEZ,QADF,CAEE,CAACZ,OAAQ,CAAT,CAFF,EAKAW,UAAUa,GAAV,CACEZ,QADF,CAEE,CACEiB,MAAOzD,KADT,CAEEsB,QAAS,CAFX,CAGED,QAAS,MAHX,CAIEiC,UAAW,KAJb,CAFF,EASD,CAfD,CAeG,CAfH,EAgBD,CAED,QAAS3B,aAAT,CAAsBa,QAAtB,CAAgC,CAC9BG,WAAW,QAASa,gBAAT,EAA2B,CACpCjB,UAAUa,GAAV,CACEZ,QADF,CAEE,CAACZ,OAAQ,CAAT,CAFF,EAKAW,UAAUa,GAAV,CACEZ,QADF,CAEE,CACEiB,MAAO,CADT,CAEEF,UAAW,CAFb,CAGED,UAAW,KAHb,CAFF,EAQD,CAdD,CAcG,CAdH,EAeD,CAED,QAAS9B,YAAT,EAAuB,CACrBe,UAAUmB,EAAV,CACE,CAACpG,SAASqG,eAAV,CAA2BrG,SAASD,IAApC,CADF,CAEE,GAFF,CAGE,CAACuG,UAAW,CAAZ,CAAeC,QAAS,KAAxB,CAHF,EAKD,CAED,QAASjD,kBAAT,EAA6B,CAC3B,GAAIrF,EAAEuI,IAAF,EAAUvI,EAAEuI,IAAF,CAAOC,OAAP,EAAd,CAAgC,CAC9BxI,EAAEuI,IAAF,CAAOE,MAAP,GACD,CAEDC,aAEA,GAAI,CAAC1I,EAAEqD,KAAF,CAAQsF,WAAR,EAAL,CAA4B,CAC1BC,mBACD,CACF,CAED,QAASzD,YAAT,EAAuB,CACrB,GAAInF,EAAE2E,KAAF,CAAQlC,YAAR,EAAsBoG,OAA1B,CAAmC,CACjCzB,WAAWpH,EAAE2E,KAAF,CAAQlC,YAAR,EAAsBoG,OAAjC,CAA0C,CAA1C,EACD,CACF,CAED,QAASzD,YAAT,EAAuB,CACrBpF,EAAEqD,KAAF,CAAQyF,WAAR,CAAoBrG,YAApB,EACAzC,EAAEqD,KAAF,CAAQ0F,SAAR,CAAkBtG,YAAlB,EACAzC,EAAEqD,KAAF,CAAQ0F,SAAR,CAAkBpG,cAAlB,EACD,CAED,QAAS+F,WAAT,EAAsB,CACpB,GAAI1I,EAAE2E,KAAF,CAAQlC,YAAR,EAAsBuG,OAA1B,CAAmC,CACjChH,SAASiH,SAAT,CAAqBjJ,EAAE2E,KAAF,CAAQlC,YAAR,EAAsBT,QAAtB,EAAkC,mEAAvD,CAEA,GAAI,CAAChC,EAAEqD,KAAF,CAAQ6F,YAAR,CAAqBzG,YAArB,CAAL,CAAyC,CACvCX,KAAKmC,SAAL,CAAeC,GAAf,CAAmB,gBAAnB,EACD,CAFD,IAEO,CACLpC,KAAKmC,SAAL,CAAekF,MAAf,CAAsB,gBAAtB,EACD,CACF,CARD,IAQO,CACLrH,KAAKmC,SAAL,CAAekF,MAAf,CAAsB,gBAAtB,EACD,CAED,GAAIxG,gBAAkB3C,EAAE2E,KAAF,CAAQhC,cAAR,EAAwBX,QAA9C,CAAwD,CACtDA,SAASiH,SAAT,CAAqBjJ,EAAE2E,KAAF,CAAQhC,cAAR,EAAwBX,QAA7C,CACD,CACF,CAED,QAAS4G,iBAAT,EAA4B,CAC1B,GAAIQ,cAAJ,CAGA,GAAMC,mBAAoB,CAACC,OAAOC,QAAP,CAAgBC,IAAhB,CAAqB,EAAtB,EAA0BC,KAA1B,CAAgC,oBAAhC,CAA1B,CAQA,GAAMC,WAAY,CAACJ,OAAOC,QAAP,CAAgBC,IAAhB,CAAqB,EAAtB,EAA0BG,KAA1B,CAAgC,gBAAhC,CAAlB,CAOA,GAAID,UAAU,CAAV,EAAalC,OAAb,CAAqB,WAArB,IAAsC,CAAC,CAA3C,CAA8C,CAC5C,MAAO,MAAP,CACD,CAED,GAAI6B,mBAAqBK,SAAzB,CAAoC,CAElCA,UAAU,CAAV,EAAeA,UAAU,CAAV,EAAaC,KAAb,CAAmB,WAAnB,EAAgC,CAAhC,CAAf,CACAP,mBAAqBM,UAAU,CAAV,CAArB,CAAoCL,kBAAkB,CAAlB,CAApC,MAA6D5G,YAA7D,CAA4EiH,UAAU,CAAV,CAA5E,CACD,CAJD,IAIO,CAELA,UAAU,CAAV,EAAeA,UAAU,CAAV,EAAaC,KAAb,CAAmB,WAAnB,EAAgC,CAAhC,CAAf,CACAP,OAAS,aAAYM,UAAU,CAAV,CAAZ,OAA8BjH,YAA9B,EAA6CmH,OAA7C,CAAqD,WAArD,CAAkE,WAAlE,CAAT,CACD,CAEDN,OAAOO,OAAP,CAAeC,SAAf,CAAyB,EAAzB,CAA6B,EAA7B,CAAiCV,MAAjC,EACD,CACF,CAOD,QAASjJ,KAAT,EAAgB,CAEd,GAAII,SAAJ,CAAc,CACZgE,QAAQwF,IAAR,CAAa,uBAAb,EACA,MAAO,MAAP,CACD,CAGD,GAAIC,cAAJ,CAAoB,CAClB,MAAO,MAAP,CACD,CAGDvH,aAAewH,aAAa9H,aAAb,CAAf,CAEA,GAAI,CAACM,YAAL,CAAmB,CACjB,MAAO,MAAP,CACD,CAGD,GACEzC,EAAE2E,KAAF,CAAQxC,aAAR,EAAuB+H,MAAvB,EACGlK,EAAE2E,KAAF,CAAQxC,aAAR,EAAuB+H,MAAvB,KAAoC,KAFzC,CAGE,CACA,MAAO,MAAP,CACD,CAED,GAAMtF,QAAS5E,EAAE2E,KAAF,CAAQxC,aAAR,EAAuByC,MAAtC,CAEA,GACEA,QACG5E,EAAE2E,KAAF,CAAQC,MAAR,EAAgBC,QAAhB,CAAyB2C,OAAzB,CAAiC/E,YAAjC,IAAmD,CAAC,CADvD,EAEGmC,OAAOsF,MAFV,EAGGtF,OAAOsF,MAAP,KAAoB,KAJzB,CAKE,CACA,MAAO,MAAP,CACD,CAGDhK,KACD,CAED,QAAS+J,aAAT,CAAsBrG,EAAtB,CAA0B,CAExB,GAAI5D,EAAE2E,KAAF,CAAQf,EAAR,EAAYgB,MAAhB,CAAwB,CACtB,GAAMA,QAAS5E,EAAE2E,KAAF,CAAQf,EAAR,EAAYgB,MAA3B,CACA,GAAMuF,UAAWnK,EAAE2E,KAAF,CAAQC,MAAR,EAAgBC,QAAjC,CACA,GAAMuF,OAAQD,SAAS3C,OAAT,CAAiB5D,EAAjB,CAAd,CAEA,GAAIwG,QAAU,CAAC,CAAf,CAAkB,CAChB7F,QAAQmB,KAAR,gBAA6B9B,EAA7B,wCAAsE5D,EAAE2E,KAAF,CAAQf,EAAR,EAAYgB,MAAlF,MACD,CAFD,IAEO,IAAIwF,MAAQ,CAAR,CAAYD,SAASE,MAAzB,CAAiC,CAEtC,MAAOF,UAASC,MAAQ,CAAjB,CAAP,CACD,CAHM,IAGA,CAELxG,GAAKgB,MAAL,CACD,CACF,CAED,GAAI5E,EAAE2E,KAAF,CAAQf,EAAR,EAAY0G,QAAhB,CAA0B,CACxB,MAAOtK,GAAE2E,KAAF,CAAQf,EAAR,EAAY0G,QAAnB,CACD,CAFD,IAEO,CACL,GAAMF,QAAQ7G,oBAAoBiE,OAApB,CAA4B5D,EAA5B,CAAd,CAEA,GAAIwG,SAAU,CAAC,CAAf,CAAkB,CAChB7F,QAAQmB,KAAR,cAA2B9B,EAA3B,6CACD,CAFD,IAEO,IAAIwG,OAAQ,CAAR,CAAY7G,oBAAoB8G,MAApC,CAA4C,CACjD,MAAO9G,qBAAoB6G,OAAQ,CAA5B,CAAP,CACD,CAFM,IAEA,CAEL7F,QAAQC,IAAR,MAAmBZ,EAAnB,wBACA,MAAO,MAAP,CACD,CACF,CAED,MAAO,MAAP,CACD,CAOD,QAASxD,KAAT,EAAgB,CAEd,GAAIG,SAAJ,CAAc,CACZgE,QAAQwF,IAAR,CAAa,uBAAb,EACA,MAAO,MAAP,CACD,CAGDtH,aAAe8H,aAAapI,aAAb,CAAf,CAEA,GAAI,CAACM,YAAL,CAAmB,CACjB,MAAO,MAAP,CACD,CAGD,GAAMoC,UAAW7E,EAAE2E,KAAF,CAAQlC,YAAR,EAAsBoC,QAAvC,CACA,GAAIA,QAAJ,CAAc,CACZpC,aAAeoC,SAASA,SAASwF,MAAT,CAAkB,CAA3B,CAAf,CACD,CAGDnK,KACD,CAGD,QAASqK,aAAT,CAAsB3G,EAAtB,CAA0B,CAExB,GAAI5D,EAAE2E,KAAF,CAAQf,EAAR,EAAYgB,MAAhB,CAAwB,CACtB,GAAMA,QAAS5E,EAAE2E,KAAF,CAAQf,EAAR,EAAYgB,MAA3B,CACA,GAAMuF,UAAWnK,EAAE2E,KAAF,CAAQC,MAAR,EAAgBC,QAAjC,CACA,GAAMuF,OAAQD,SAAS3C,OAAT,CAAiB5D,EAAjB,CAAd,CAEA,GAAIwG,QAAU,CAAC,CAAf,CAAkB,CAChB7F,QAAQmB,KAAR,gBAA6B9B,EAA7B,wCAAsE5D,EAAE2E,KAAF,CAAQf,EAAR,EAAYgB,MAAlF,MACD,CAFD,IAEO,IAAIwF,MAAQ,CAAZ,CAAe,CAEpB,MAAOD,UAASC,MAAQ,CAAjB,CAAP,CACD,CAHM,IAGA,CAELxG,GAAKgB,MAAL,CACD,CACF,CAED,GAAI5E,EAAE2E,KAAF,CAAQf,EAAR,EAAY4G,QAAhB,CAA0B,CACxB,MAAOxK,GAAE2E,KAAF,CAAQf,EAAR,EAAY4G,QAAnB,CACD,CAFD,IAEO,CACL,GAAMJ,SAAQ7G,oBAAoBiE,OAApB,CAA4B5D,EAA5B,CAAd,CAEA,GAAIwG,UAAU,CAAC,CAAf,CAAkB,CAChB7F,QAAQmB,KAAR,cAA2B9B,EAA3B,6CACD,CAFD,IAEO,IAAIwG,QAAQ,CAAZ,CAAe,CACpB,MAAO7G,qBAAoB6G,QAAQ,CAA5B,CAAP,CACD,CAFM,IAEA,CAEL7F,QAAQC,IAAR,MAAmBZ,EAAnB,yBACA,MAAO,MAAP,CACD,CACF,CAED,MAAO,MAAP,CACD,CAED,QAASpD,SAAT,EAAoB,CAClBsB,KAAKmC,SAAL,CAAeC,GAAf,CAAmB,YAAnB,EACAnC,SAAS0I,gBAAT,CAA0B,SAA1B,CAAqCC,WAArC,EACD,CAED,QAASjK,SAAT,EAAoB,CAClBqB,KAAKmC,SAAL,CAAekF,MAAf,CAAsB,YAAtB,EACApH,SAAS4I,mBAAT,CAA6B,SAA7B,CAAwCD,WAAxC,EACD,CAQD,QAASV,aAAT,EAAwB,CACtB,GACE,CAAChK,EAAE2E,KAAF,CAAQxC,aAAR,EAAuB6G,OAAxB,EACG,EAAE5G,iBAAmBpC,EAAE2E,KAAF,CAAQvC,eAAR,EAAyB4G,OAA9C,CAFL,CAGE,CAEA,MAAO,MAAP,CACD,CAED,GAAIhJ,EAAEqD,KAAF,CAAQ6F,YAAR,CAAqB/G,aAArB,CAAJ,CAAyC,CAEvC,MAAO,MAAP,CACD,CAED,GAAInC,EAAEuI,IAAF,EAAUvI,EAAEuI,IAAF,CAAOqC,UAAP,EAAd,CAAmC,CAEjC,MAAO,MAAP,CACD,CAED,GAAI5K,EAAE2E,KAAF,CAAQxC,aAAR,EAAuB0I,MAAvB,EAAiC7K,EAAE2E,KAAF,CAAQxC,aAAR,EAAuB0I,MAAvB,EAArC,CAAsE,CAEpE,MAAO,MAAP,CACD,CAHD,IAGO,CACLtG,QAAQwF,IAAR,CAAa,YAAY5H,aAAZ,CAA0B,4BAAvC,EACD,CAGDoC,QAAQwF,IAAR,CAAa,8BAAb,EACAvJ,WAEA,MAAO,KAAP,CACD,CAED,QAASsK,YAAT,CAAqBC,IAArB,CAA2B,CACzB/I,SAASiH,SAAT,CAAqB8B,IAArB,CACD,CAED,QAASrK,SAAT,CAAkBkD,EAAlB,CAAsB,CAEpBA,GAAKA,IAAMzB,aAAX,CACAnC,EAAEqD,KAAF,CAAQ2H,YAAR,CAAqBpH,EAArB,EACA9B,KAAKmC,SAAL,CAAekF,MAAf,CAAsB,gBAAtB,EACD,CAED,QAASuB,YAAT,CAAqBO,KAArB,CAA4B,CAE1B,GAAIA,MAAMC,OAAN,EAAiB,EAAjB,EAAuBD,MAAMC,OAAN,EAAiB,EAAxC,EAA8CD,MAAMC,OAAN,EAAiB,EAAnE,CAAuE,CACrED,MAAME,cAAN,GACA1K,WAGAwK,MAAMG,eAAN,GACD,CACF,CAED,GAAIC,SAAU,GAAIC,YAAJ,CAAgB,CAACC,OAAQ,IAAT,CAAeC,OAAQ,CAAC,CAAxB,CAAhB,CAAd,CACA,GAAIC,WAAY1J,SAAS2J,gBAAT,CAA0B,sBAA1B,CAAhB,CACA,GAAIC,YAAa,GAAjB,CAEAN,QAAQnH,GAAR,CACE8C,UAAUmB,EAAV,CACEsD,SADF,CAEEE,UAFF,CAGE,CACE5F,QAAS,CADX,CAEE6F,KAAMC,KAAKC,SAFb,CAHF,CADF,EAWAT,QAAQnH,GAAR,CACE8C,UAAUmB,EAAV,CACEsD,SADF,CAEEE,UAFF,CAGE,CACE5F,QAAS,GADX,CAEE6F,KAAMC,KAAKC,SAFb,CAHF,CADF,CASI,KAAOH,WAAW,CATtB,EAYAN,QAAQnH,GAAR,CACE8C,UAAUa,GAAV,CAAc,EAAd,CAAiB,EAAjB,CADF,CAEI,KAAO8D,WAAW,CAFtB,EAKA/K,YAEA,QAASD,MAAT,EAAiB,CACf0K,QAAQrK,IAAR,GACD,CAED,QAASJ,UAAT,EAAqB,CACnByK,QAAQjK,KAAR,GACA4F,UAAUa,GAAV,CAAc4D,SAAd,CAAyB,CAACM,WAAY,KAAb,CAAzB,EACD,CAKD,QAASlL,iBAAT,EAA4B,CAC1B,GAAIb,EAAEuI,IAAN,CAAY,CACVvI,EAAEuI,IAAF,CAAOyD,KAAP,GACD,CAEDvL,WACAG,YACD,CAED,QAASK,UAAT,CAAmBiC,OAAnB,CAA4B,CAC1B,GAAI,CAACH,YAAL,CAAmB,CACjB,MAAO,MAAP,CACD,CAGD,GAAIC,iBAAmBE,UAAYF,eAAnC,CAAoD,CAClDiJ,cACA,MAAO,KAAP,CACD,CAED9K,YAGA,GAAI,MAAOY,UAASmK,MAAhB,GAA2B,SAA3B,EAAwCnK,SAASmK,MAArD,CAA6D,CAC3D,MAAO,MAAP,CACD,CAGD,GAAI,MAAOhJ,QAAP,GAAmB,QAAnB,EAA+BA,QAAQmH,MAAR,GAAmB,CAAtD,CAAyD,CACvD,MAAO,MAAP,CACD,CAED,GAAI,CAACjH,OAAL,CAAc,CACZ+I,SAASjJ,OAAT,EACAF,gBAAkBE,OAAlB,CAEAD,aAAemE,WAAW,UAAY,CACpC,GAAG,CAACpE,eAAJ,CAAqB,CACnBuB,QAAQkB,GAAR,CAAY,gBAAZ,EACA,MAAO,MAAP,CACD,CAHD,IAGO,CACL,GAAI2G,MAAOjJ,WAAWH,eAAX,CAAX,CAEA,GAAI,CAACI,OAAL,CAAc,CAEZ4D,UAAUa,GAAV,CAAcuE,IAAd,CAAoB,CAACC,OAAQ,CAAT,CAAYtE,UAAW,KAAvB,CAApB,EACAqE,KAAKE,WAAL,CAAmB,CAAnB,CACAF,KAAKpL,IAAL,GACD,CACF,CACF,CAdc,CAcZ,GAdY,CAAf,CAeD,CAnBD,IAmBO,CAELgC,gBAAkBE,OAAlB,CACD,CACF,CAMD,QAASiJ,SAAT,CAAkBjJ,OAAlB,CAA2B,CACzB,GAAI,CAACH,YAAL,CAAmB,CACjB,MAAO,MAAP,CACD,CAED,GAAIqJ,KAAJ,CAEA,GAAIjJ,WAAWD,OAAX,CAAJ,CAAwB,CAEtBkJ,KAAOjJ,WAAWD,OAAX,CAAP,CACD,CAHD,IAGO,CAEL,GAAIE,OAAJ,CAAa,CACX,MAAO,MAAP,CACD,CAED,GAAImJ,UAAW,SAAWrJ,OAA1B,CAGA,GAAIqJ,SAASC,MAAT,CAAgB,CAAC,CAAjB,IAAwB,MAA5B,CAAoC,CAClCD,UAAY,MAAZ,CACD,CAEDH,KAAO,GAAIrL,MAAJ,CAAUwL,QAAV,CAAP,CACApJ,WAAWD,OAAX,EAAsBkJ,IAAtB,CACD,CAED,MAAOA,KAAP,CACD,CAED,QAAS/K,WAAT,CAAoBoD,KAApB,CAA2B,CACzB,GAAI,CAAC1B,YAAL,CAAmB,CACjB,MAAO,MAAP,CACD,CAED,GAAI,MAAO0B,MAAP,GAAiB,QAArB,CAA+B,CAC7BA,MAAQ,GAAR,CACD,CAED,GAAI2H,MAAOjJ,WAAWH,eAAX,CAAX,CAEA,GAAIoJ,IAAJ,CAAU,CAERpF,UAAUmB,EAAV,CACEiE,IADF,CAEE3H,KAFF,CAGE,CACE4H,OAAQ,CADV,CAEEI,WAAY,qBAAY,CACtBL,KAAKhL,KAAL,GACD,CAJH,CAKEwK,KAAM,cALR,CAME7D,UAAW,KANb,CAHF,EAYD,CACF,CAED,QAAS5G,UAAT,CAAmBsD,KAAnB,CAA0B,CACxB,GAAI,CAAC1B,YAAD,EAAiB,CAACI,UAAtB,CAAkC,CAChC,MAAO,MAAP,CACD,CAED,GAAI,MAAOsB,MAAP,GAAiB,QAArB,CAA+B,CAC7BA,MAAQ,GAAR,CACD,CAED,GAAI2H,MAAOjJ,WAAWH,eAAX,CAAX,CAEA,GAAIoJ,MAAQ,CAACA,KAAKb,MAAd,EAAwBa,KAAKE,WAAjC,CAA8C,CAE5CtF,UAAUmB,EAAV,CACEiE,IADF,CAEE3H,KAFF,CAGE,CACE4H,OAAQ,CADV,CAEEI,WAAY,qBAAY,CACtBL,KAAKhL,KAAL,GAEA,GAAIgL,KAAKE,WAAT,CAAsB,CACpBF,KAAKE,WAAL,CAAmB,CAAnB,CACD,CACF,CARH,CASEV,KAAM,cATR,CAUE7D,UAAW,KAVb,CAHF,EAgBD,CAED/E,gBAAkB,KAAlB,CACD,CAED,QAASiJ,YAAT,EAAuB,CACrB,GAAI,CAAClJ,YAAL,CAAmB,CACjB,MAAO,MAAP,CACD,CAED,GAAIC,eAAJ,CAAqB,CACnB,GAAIoJ,MAAOD,SAASnJ,eAAT,CAAX,CAEA,GAAIoJ,KAAKM,KAAT,CAAgB,CAEd,MAAO,MAAP,CACD,CAED,GAAI,CAACN,KAAKb,MAAN,EAAgBa,KAAKE,WAAzB,CAAsC,CAEpC/H,QAAQC,IAAR,CAAa,YAAcxB,eAAd,CAAgC,sBAA7C,EAEA,MAAO,MAAP,CACD,CAGD,GAAIsJ,aAAcF,KAAKE,WAAvB,CACA,GAAIA,YAAc,GAAlB,CAAuB,CACrBF,KAAKE,WAAL,CAAmBA,YAAc,GAAjC,CACD,CAFD,IAEO,IAAIF,KAAKE,WAAT,CAAsB,CAC3BF,KAAKE,WAAL,CAAmB,CAAnB,CACD,CAGD,GAAI,CAAClJ,OAAL,CAAc,CACZgJ,KAAKpL,IAAL,GACAgG,UAAUmB,EAAV,CACEiE,IADF,CAEE,GAFF,CAGE,CACEC,OAAQ,CADV,CAEET,KAAMe,KAAKC,MAFb,CAGE7E,UAAW,KAHb,CAHF,EASD,CACF,CACF,CAED,QAASxG,UAAT,EAAqB,CACnB,GAAI,CAACwB,YAAL,CAAmB,CACjB,MAAO,MAAP,CACD,CAEDK,QAAU,IAAV,CACApD,EAAEqD,KAAF,CAAQwE,GAAR,CAAY,MAAZ,CAAoB,IAApB,EAEA,GAAI7E,eAAJ,CAAqB,CACnB3B,aACD,CACF,CAED,QAASI,YAAT,EAAuB,CACrB,GAAI,CAACsB,YAAL,CAAmB,CACjB,MAAO,MAAP,CACD,CAEDK,QAAU,KAAV,CACApD,EAAEqD,KAAF,CAAQwE,GAAR,CAAY,MAAZ,CAAoB,KAApB,EAEA,GAAI7E,eAAJ,CAAqB,CACnBiJ,cACD,CACF,CAED,QAAStK,aAAT,EAAwB,CACtBI,SAASD,IAAT,CAAcmC,SAAd,CAAwBC,GAAxB,CAA4B,iBAA5B,EACA/C,YACA4B,aAAe,KAAf,CACD,CAED,QAASlB,YAAT,EAAuB,CACrB,GAAIyH,OAAOuD,UAAP,CAAkB,mBAAlB,EAAuCC,OAAvC,EAAkD9M,EAAE+M,OAAF,CAAUC,MAAV,CAAiBC,QAAvE,CAAiF,CAC/ElL,SAASD,IAAT,CAAcmC,SAAd,CAAwBkF,MAAxB,CAA+B,iBAA/B,EACApG,aAAe,IAAf,CAEA,MAAO,KAAP,CACD,CAED,MAAO,MAAP,CACD,CAED,QAASiB,eAAT,EAA0B,CAExB,GAAMkJ,YAAanL,SAASoL,cAAT,CAAwB,aAAxB,CAAnB,CAEA,GAAID,YAAcnK,YAAlB,CAA+B,CAC7B,GAAIK,OAAJ,CAAa,CAEX8J,WAAWjJ,SAAX,CAAqBC,GAArB,CAAyB,WAAzB,EACD,CAGDgJ,WAAWzC,gBAAX,CAA4B,OAA5B,CAAqC,UAAY,CAC/C,GAAIrH,OAAJ,CAAa,CACX8J,WAAWjJ,SAAX,CAAqBkF,MAArB,CAA4B,WAA5B,EACA1H,cACD,CAHD,IAGO,CACLyL,WAAWjJ,SAAX,CAAqBC,GAArB,CAAyB,WAAzB,EACA3C,YACD,CACF,CARD,EASD,CACF,CAED,QAAS4C,sBAAT,EAAiC,CAE/B,GAAMiJ,eAAgBC,EAAEC,QAAF,CAAWnN,IAAX,CAAiB,GAAjB,CAAtB,CACA,GAAMoN,eAAgBF,EAAEC,QAAF,CAAWlN,IAAX,CAAiB,GAAjB,CAAtB,CAEA2B,SAAS0I,gBAAT,CAA0B,SAA1B,CAAqC+C,iBAArC,EAEA,QAASA,kBAAT,CAA2BvC,KAA3B,CAAkC,CAChC,GAAIoC,EAAEI,YAAF,CAAexC,KAAf,CAAJ,CAA2B,CACzB,MAAO,MAAP,CACD,CAGD,GAAIA,MAAMC,OAAN,EAAiB,EAArB,CAAyB,CACvBkC,gBACD,CAGD,GAAInC,MAAMC,OAAN,EAAiB,EAArB,CAAyB,CACvBqC,gBACD,CAED,GAAI,CAACvN,EAAEqD,KAAF,CAAQsF,WAAR,EAAL,CAA4B,CAE1B,GAAIsC,MAAMC,OAAN,EAAiB,EAArB,CAAyB,CACvB,GAAIlL,EAAEuI,IAAN,CAAY,CACVvI,EAAEuI,IAAF,CAAOjI,MAAP,GACD,CACF,CAGD,GAAI2K,MAAMC,OAAN,EAAiB,EAArB,CAAyB,CACvB5B,OAAOoE,IAAP,CAAY1N,EAAEqD,KAAF,CAAQoC,GAAR,EAAZ,EACD,CACF,CACF,CACF,CACF,CA5lCA,EA4lCE6D,OAAOtJ,CA5lCT","file":"../V.Navigation.min.js","sourcesContent":[";(function initNavigation(V) {\r\n  V.Navigation = {\r\n    go,\r\n    next,\r\n    prev,\r\n    lock,\r\n    unlock,\r\n    isLocked() {return isLocked;},\r\n    showGate,\r\n    hideGate,\r\n    openGate,\r\n    blink,\r\n    stopBlink,\r\n    closePeripherals,\r\n    setOrder\r\n  };\r\n\r\n  V.Audio = {\r\n    play: playAudio,\r\n    stop: stopAudio,\r\n    pause: pauseAudio,\r\n    mute: muteAudio,\r\n    unmute: unmuteAudio,\r\n    disable: disableAudio,\r\n    enable: enableAudio\r\n  };\r\n\r\n  // DOM elements\r\n  const body = document.body;\r\n  const gateText = document.querySelector('.gate__text');\r\n\r\n  // page variables\r\n  let currentPageElement;\r\n  let currentPageId;\r\n  let currentParentId;\r\n  let currentParentElement;\r\n  let currentTimelineId;\r\n  let tl;\r\n  let targetPageElement;\r\n  let targetPageId;\r\n  let targetParentElement;\r\n  let targetParentId;\r\n  let isTimelinesActive = V.Timelines && V.Timelines.isActive;\r\n\r\n  // Navigation locking for lightboxes   \r\n  let isLocked = false;\r\n\r\n  function lock() {\r\n    isLocked = true;\r\n  }\r\n\r\n  function unlock() {\r\n    isLocked = false;\r\n  }\r\n\r\n  // audio variables\r\n  let audioEnabled = enableAudio();\r\n  let audioNowPlaying;\r\n  let audioTimeout;\r\n  let audioId;\r\n  let audioFiles = {};\r\n  let isMuted = !!V.SCORM.get('mute');\r\n\r\n  // set navigation order as array of page IDs from DOM\r\n  let pageNavigationOrder = Array.from(\r\n    document.getElementsByClassName('page'),\r\n    (page) => page.id\r\n  );\r\n\r\n  function setOrder(pageList) {\r\n    pageNavigationOrder = pageList;\r\n  }\r\n\r\n  if (audioEnabled) {\r\n    CustomEase.create('audioEaseOut', 'M0,0 C0,0.9 0.1,1 1,1');\r\n    initMuteButton();\r\n  } else {\r\n    document.body.classList.add('-audio-disabled');\r\n  }\r\n\r\n  initNavigateOnKeydown();\r\n\r\n  /**\r\n   * Navigates to a page. By default, navigates to `targetPageId`\r\n   * saved in this function's closure. If the single parameter \r\n   * `options` is a string, or is an object and has property `id`,\r\n   * then navigates to the page with that ID.\r\n   *\r\n   * @param {(string|object)} options - Describes where or how to navigate.\r\n   */\r\n  function go(id, options) {\r\n    options = options || {};\r\n\r\n    // legacy support for one parameter\r\n    if (typeof id === 'object') {\r\n      options = id;\r\n    }\r\n\r\n    // look for the target page\r\n    if (typeof id === 'string') {\r\n      // `id` is the page ID\r\n      targetPageId = id;\r\n    } else if (id instanceof Element && id.classList.contains('page')) {\r\n      // `id` is the page element\r\n      targetPageId = id.id;\r\n    } else if (options.id) {\r\n      // legacy support for one parameter\r\n      targetPageId = options.id;\r\n    }\r\n\r\n    // are we still missing a target page?\r\n    if (!targetPageId) {\r\n      console.warn(`V.Navigation.go() called with no target page.`);\r\n    }\r\n\r\n    const trDur = options.transitionDuration || 0.3;\r\n\r\n    // get parent page if it exists\r\n    let targetParentId = V.Pages[targetPageId] && V.Pages[targetPageId].parent;\r\n\r\n    // if target page has children, go to its first child\r\n    if (V.Pages[targetPageId] && V.Pages[targetPageId].children) {\r\n      targetParentId = targetPageId;\r\n      targetPageId = V.Pages[targetPageId].children[0];\r\n    }\r\n    \r\n    if (!isNewPageValid()) {\r\n      return false;\r\n    }\r\n\r\n    // check if there's an `onLeave` callback and cancel navigation if it returns false\r\n    if (\r\n      currentPageId \r\n      && V.Pages[currentPageId].onLeave \r\n      && V.Pages[currentPageId].onLeave(targetPageId) === false\r\n    ) {\r\n      return false;\r\n    }\r\n\r\n    // get target page elements\r\n    targetPageElement  = V.Pages[targetPageId].element;\r\n    targetParentId  = V.Pages[targetPageId].parent;\r\n    targetParentElement  = targetParentId ? V.Pages[targetParentId].element : null;\r\n\r\n    // get current page elements\r\n    if (currentPageId) {\r\n      currentPageElement = V.Pages[currentPageId].element;\r\n      currentParentId = V.Pages[currentPageId].parent;\r\n      currentParentElement = currentParentId ? V.Pages[currentParentId].element : null;\r\n    }\r\n\r\n    // before transition\r\n    closePeripherals();\r\n\r\n    // audio\r\n    if (audioEnabled) {\r\n      playAudio(V.Pages[targetPageId].audio);\r\n    }\r\n\r\n    // transition\r\n    transition();\r\n\r\n    // after transition\r\n    callOnEnter();\r\n    updateSCORM();\r\n    updatePeripherals();\r\n\r\n    currentPageId = targetPageId;\r\n    currentPageElement = targetPageElement;\r\n    currentParentId = targetParentId;\r\n    currentParentElement = targetParentElement;\r\n\r\n    if (V.Pages[currentPageId].hasInnerPages && !innerPageIds) {\r\n      navigateToInnerPage(0);\r\n    }\r\n\r\n    return true;\r\n\r\n    /**\r\n     * Checks if new page is valid for navigation.\r\n     *\r\n     * @return {Boolean} - Valid or not.\r\n     */\r\n    function isNewPageValid(){ \r\n      if (\r\n        !targetParentId \r\n        && currentPageId \r\n        && targetPageId === V.Pages[currentPageId].parent\r\n      ) {\r\n        console.log('\"', targetPageId, '\"is the parent of the current page, \"', currentPageId, '\"');\r\n        return false;\r\n      }\r\n\r\n      // error if the page is missing from V.Pages.js\r\n      if (!V.Pages[targetPageId]) {\r\n        console.error('The page', targetPageId, 'is not registered in the `V.Pages` object.');\r\n        return false;\r\n      }\r\n\r\n      // error if page doesn't exist\r\n      if (!V.Pages[targetPageId].element) {\r\n        console.error('Error: Can\\'t navigate to', targetPageId, 'because that page doesnâ€™t exist.');\r\n        return false;\r\n      }\r\n\r\n\r\n      // error if navigating to currently open page\r\n      if (targetPageId === currentPageId) {\r\n        console.log('Can\\'t navigate to', targetPageId, 'because that page is already open!');\r\n        return false;\r\n      }\r\n\r\n      return true;\r\n    }\r\n\r\n    /**\r\n     * Transitions to the next page.\r\n     */\r\n    function transition() {\r\n      if (targetParentId) {\r\n        openChildPage();\r\n      } else {\r\n        openNewPage();\r\n      }\r\n    }\r\n\r\n    function openNewPage() {\r\n      var transition = options.transition || 'fade';\r\n\r\n      if (!currentPageElement) {\r\n        // first page of session\r\n        if (transition !== 'fade') {\r\n          targetPageElement.style.display = 'block';\r\n          targetPageElement.style.opacity = 1;\r\n        } else {\r\n          fadeIn(targetPageElement);\r\n        }\r\n      } else {\r\n        scrollToTop();\r\n\r\n        if (currentTimelineId) {\r\n          endCurrentTimeline();\r\n        }\r\n\r\n        if (transition == 'fade') {\r\n          fadeIn(targetPageElement);\r\n          if (currentParentId) {\r\n            fadeOut(currentParentElement);\r\n            fadeOutChild(currentPageElement);\r\n          } else {\r\n            fadeOut(currentPageElement);\r\n          }\r\n        } else {\r\n          targetPageElement.style.zIndex = 2;\r\n          targetPageElement.style.display = 'block';\r\n          currentPageElement.style.zIndex = 1;\r\n          currentPageElement.style.display = 'none';\r\n        }\r\n      }\r\n    }\r\n\r\n    function openChildPage() {\r\n      if (tl) console.log('label: ', tl.currentLabel());\r\n\r\n      var transition = options.transition || 'fade';\r\n\r\n      if (!currentPageElement) {\r\n        // first page of session\r\n\r\n        if (isTargetInTimeline()) {\r\n          startNewTimeline();\r\n          targetParentElement.style.display = 'block';\r\n          targetParentElement.style.opacity = 1;\r\n        } else {\r\n          targetParentElement.style.display = 'block';\r\n          targetParentElement.style.opacity = 1;\r\n          targetPageElement.style.visibility = 'visible';\r\n          targetPageElement.style.opacity = 1;\r\n        }\r\n      } else {\r\n        scrollToTop();        \r\n\r\n        if (transition == 'fade') {\r\n          if (currentParentId === targetParentId) {\r\n            // from sibling\r\n            if (isTargetInTimeline()) {\r\n              tweenWithinTimeline();\r\n            } else {\r\n              fadeInChild(targetPageElement);\r\n              fadeOutChild(currentPageElement);\r\n            }\r\n          } else if (currentParentId) {\r\n            // from cousin\r\n            if (isTargetInTimeline()) {\r\n              endCurrentTimeline();\r\n              startNewTimeline();\r\n            } else {\r\n              fadeIn(targetParentElement);\r\n              fadeInChild(targetPageElement);\r\n              fadeOut(currentParentElement);\r\n              fadeOutChild(currentPageElement);\r\n            }\r\n          } else {\r\n            // from uncle\r\n            if (isTargetInTimeline()) {\r\n              startNewTimeline();         \r\n            } else {\r\n              fadeInChild(targetPageElement);       \r\n            }\r\n\r\n            fadeIn(targetParentElement);\r\n            fadeOut(currentPageElement); \r\n          }\r\n        } else {\r\n          targetParentElement.style.zIndex = 2;\r\n          targetParentElement.style.display = 'block';\r\n          targetPageElement.style.zIndex = 2;\r\n          targetPageElement.style.display = 'visible';\r\n          currentPageElement.style.zIndex = 1;\r\n          currentPageElement.style.display = 'none';\r\n        }\r\n      }\r\n\r\n      // current parent should be stored from previous go() call\r\n      currentParentId = targetParentId;\r\n      currentParentElement = targetParentElement;\r\n    }\r\n\r\n\r\n    function isTargetInTimeline() {\r\n      return isTimelinesActive && V.Timelines[targetParentId];\r\n    }\r\n\r\n\r\n    function endCurrentTimeline() {\r\n      // kill its animations\r\n      V.Timelines[currentTimelineId].kill();\r\n\r\n      // hide its pages\r\n      fadeOut(V.Timelines[currentTimelineId].pagesSelector);\r\n\r\n      // unset the scoped variable\r\n      currentTimelineId = undefined;\r\n    }\r\n\r\n    function startNewTimeline() {\r\n      currentTimelineId = targetParentId;\r\n      tl = V.Timelines[currentTimelineId];\r\n\r\n      var $pages = TweenLite.selector(tl.pagesSelector);\r\n\r\n      if (tl.needsRebuild) {\r\n        tl.build();\r\n        V.Timelines[currentTimelineId].needsRebuild = false;\r\n      }\r\n\r\n      setTimeout(tl.play.bind(tl, targetPageId), 0);\r\n      // fadeIn($pages);\r\n    }\r\n\r\n    function tweenWithinTimeline() {\r\n      // validate our labelNames array\r\n      if (tl.labelNames) {\r\n        var currentLabelIndex = tl.labelNames.indexOf(tl.currentLabel());\r\n        var idLabelIndex = tl.labelNames.indexOf(targetPageId);\r\n    \r\n        if (currentLabelIndex - 1 == idLabelIndex && idLabelIndex > 0) {\r\n          // play back 1\r\n          tl.reverse(currentLabelIndex);\r\n        } else if (currentLabelIndex + 1 == idLabelIndex) {\r\n          // play forward 1\r\n          tl.play(targetPageId);\r\n        } else {\r\n          // tween to final state\r\n          tl.tweenTo(tl.labelNames[idLabelIndex + 1]);\r\n        }\r\n      } else {\r\n        tl.play(targetPageId);\r\n      }\r\n    }\r\n\r\n    function fadeIn(selector) {\r\n      setTimeout(function fadeInDeferred() {\r\n        TweenLite.set(\r\n          selector,\r\n          {zIndex: 2}\r\n        );\r\n\r\n        TweenLite.fromTo(\r\n          selector,\r\n          trDur,\r\n          {\r\n            opacity: 0\r\n          },\r\n          {\r\n            opacity: 1,\r\n            display: 'block',\r\n            overwrite: 'all'\r\n          }\r\n        );\r\n      }, 0);\r\n    }\r\n\r\n    function fadeInChild(selector) {\r\n      setTimeout(function fadeInDeferred() {\r\n        TweenLite.set(\r\n          selector,\r\n          {zIndex: 2}\r\n        );\r\n\r\n        TweenLite.fromTo(\r\n          selector,\r\n          0,\r\n          {\r\n            autoAlpha: 0\r\n          },\r\n          {\r\n            autoAlpha: 1,\r\n            overwrite: 'all'\r\n          }\r\n        );\r\n      }, 0);\r\n    }\r\n\r\n    function fadeOut(selector) {\r\n      setTimeout(function fadeOutDeferred() {\r\n        TweenLite.set(\r\n          selector,\r\n          {zIndex: 1}\r\n        );\r\n\r\n        TweenLite.set(\r\n          selector,\r\n          {\r\n            delay: trDur,\r\n            opacity: 0,\r\n            display: 'none',\r\n            overwrite: 'all'\r\n          }\r\n        );\r\n      }, 0);\r\n    }\r\n\r\n    function fadeOutChild(selector) {\r\n      setTimeout(function fadeOutDeferred() {\r\n        TweenLite.set(\r\n          selector,\r\n          {zIndex: 1}\r\n        );\r\n\r\n        TweenLite.set(\r\n          selector,\r\n          {\r\n            delay: 0,\r\n            autoAlpha: 0,\r\n            overwrite: 'all'\r\n          }\r\n        );\r\n      }, 0);\r\n    }\r\n\r\n    function scrollToTop() {\r\n      TweenLite.to(\r\n        [document.documentElement, document.body],\r\n        0.3,\r\n        {scrollTop: 0, autoCSS: false}\r\n      );\r\n    }\r\n\r\n    function updatePeripherals() {\r\n      if (V.Menu && V.Menu.getList()) {\r\n        V.Menu.render();\r\n      }\r\n\r\n      updateGate();\r\n\r\n      if (!V.SCORM.isConnected()) {\r\n        updateAddressBar();\r\n      }\r\n    }\r\n\r\n    function callOnEnter() {\r\n      if (V.Pages[targetPageId].onEnter) {\r\n        setTimeout(V.Pages[targetPageId].onEnter, 0);\r\n      }\r\n    }\r\n\r\n    function updateSCORM() {\r\n      V.SCORM.setLocation(targetPageId);\r\n      V.SCORM.setViewed(targetPageId);\r\n      V.SCORM.setViewed(targetParentId);\r\n    }\r\n\r\n    function updateGate() {\r\n      if (V.Pages[targetPageId].hasGate) {\r\n        gateText.innerHTML = V.Pages[targetPageId].gateText || 'Please complete this activity before proceeding to the next page.';\r\n\r\n        if (!V.SCORM.getCompleted(targetPageId)) {\r\n          body.classList.add('-next-disabled');\r\n        } else {\r\n          body.classList.remove('-next-disabled');\r\n        }\r\n      } else {\r\n        body.classList.remove('-next-disabled');\r\n      }\r\n\r\n      if (targetParentId && V.Pages[targetParentId].gateText) {\r\n        gateText.innerHTML = V.Pages[targetParentId].gateText;\r\n      }\r\n    }\r\n    \r\n    function updateAddressBar() {\r\n      let newURL;\r\n\r\n      // find the `p` parameter\r\n      const currentURLmatches = (window.location.href+'').match(/([\\?&])p=([^\\?&]*)/);\r\n      /**\r\n       * currentURLmatches[0] => '?p=current_page'\r\n       * currentURLmatches[1] => '?' or '&'\r\n       * currentURLmatches[2] => 'current_page'\r\n       */\r\n      \r\n      // find everything around the `p` parameter\r\n      const restOfURL = (window.location.href+'').split(/[\\?&]p=[^\\?&]*/);\r\n      /**\r\n       * restOfURL[0] => 'http://localhost:3084/app.html', \r\n       * restOfURL[1] => '&sd=...&score=...&Var_firm_name=...', \r\n       */\r\n      \r\n      // return if not in app.html\r\n      if (restOfURL[0].indexOf('/app.html') === -1) {\r\n        return false;\r\n      }\r\n\r\n      if (currentURLmatches && restOfURL) {\r\n        // build new URL and pushState it\r\n        restOfURL[0] = restOfURL[0].split('/app.html')[1];\r\n        newURL = `/app.html${restOfURL[0]}${currentURLmatches[1]}p=${targetPageId}${restOfURL[1]}`;\r\n      } else {\r\n        // no `p` yet, so append to current URL\r\n        restOfURL[1] = restOfURL[0].split('/app.html')[1];\r\n        newURL = `/app.html${restOfURL[1]}&p=${targetPageId}`.replace('app.html&', 'app.html?');\r\n      }\r\n\r\n      window.history.pushState({}, '', newURL);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Gets the next page ID from `V.Pages[oldId].nextPage`.\r\n   * If that doesn't exist, gets the ID of next `.page` in DOM.\r\n   * Then navigates with `goToPageById`.\r\n   */\r\n  function next() {\r\n    // check if locked\r\n    if (isLocked) {\r\n      console.info('Navigation is locked.');\r\n      return false;\r\n    }\r\n\r\n    // check if gate is closed\r\n    if (isGateClosed()) {\r\n      return false;\r\n    }\r\n\r\n    // find next page\r\n    targetPageId = findNextPage(currentPageId);\r\n\r\n    if (!targetPageId) {\r\n      return false;\r\n    }\r\n\r\n    // abort if `onNext` returns false\r\n    if (\r\n      V.Pages[currentPageId].onNext \r\n      && V.Pages[currentPageId].onNext() === false\r\n    ) {\r\n      return false;\r\n    }\r\n\r\n    const parent = V.Pages[currentPageId].parent;\r\n    // if leaving parent from its last child page, call `onNext` of parent\r\n    if (\r\n      parent\r\n      && V.Pages[parent].children.indexOf(targetPageId) === -1\r\n      && parent.onNext \r\n      && parent.onNext() === false\r\n    ) {\r\n      return false;\r\n    }\r\n\r\n    // navigate to the new page\r\n    go();\r\n  }\r\n\r\n  function findNextPage(id) {\r\n    // find next child page\r\n    if (V.Pages[id].parent) {\r\n      const parent = V.Pages[id].parent;\r\n      const siblings = V.Pages[parent].children;\r\n      const index = siblings.indexOf(id);\r\n\r\n      if (index === -1) {\r\n        console.error(`Child page #${id} was not registered to its parent, #${V.Pages[id].parent}.`);\r\n      } else if (index + 1 < siblings.length) {\r\n        // next page is next sibling\r\n        return siblings[index + 1];\r\n      } else {\r\n        // last child, get next of parent\r\n        id = parent;\r\n      } \r\n    }\r\n\r\n    if (V.Pages[id].nextPage) {\r\n      return V.Pages[id].nextPage;\r\n    } else {\r\n      const index = pageNavigationOrder.indexOf(id);\r\n\r\n      if (index === -1) {\r\n        console.error(`The page #${id} was not found in \\`pageNavigationOrder\\`.`);\r\n      } else if (index + 1 < pageNavigationOrder.length) {\r\n        return pageNavigationOrder[index + 1];\r\n      } else {\r\n        // last page\r\n        console.warn(`\\`#${id}\\` is the last page.`)\r\n        return false;\r\n      } \r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * Gets the previous page ID from `V.Pages[oldId].prevPage`.\r\n   * If that doesn't exist, gets the ID of previous `.page` in DOM.\r\n   * Then navigates with `goToPageById`.\r\n   */\r\n  function prev() {\r\n    // check if locked\r\n    if (isLocked) {\r\n      console.info('Navigation is locked.');\r\n      return false;\r\n    }\r\n\r\n    // find previous page\r\n    targetPageId = findPrevPage(currentPageId);\r\n\r\n    if (!targetPageId) {\r\n      return false;\r\n    }\r\n\r\n    // if target page has children, then target is its last child\r\n    const children = V.Pages[targetPageId].children;\r\n    if (children) {\r\n      targetPageId = children[children.length - 1];\r\n    }\r\n\r\n    // navigate to the new page\r\n    go();\r\n  }\r\n\r\n\r\n  function findPrevPage(id) {\r\n    // find previous child page\r\n    if (V.Pages[id].parent) {\r\n      const parent = V.Pages[id].parent;\r\n      const siblings = V.Pages[parent].children;\r\n      const index = siblings.indexOf(id);\r\n\r\n      if (index === -1) {\r\n        console.error(`Child page #${id} was not registered to its parent, #${V.Pages[id].parent}.`);\r\n      } else if (index > 0) {\r\n        // previous page is previous sibling\r\n        return siblings[index - 1];\r\n      } else {\r\n        // last child, get previous of parent\r\n        id = parent;\r\n      } \r\n    }\r\n\r\n    if (V.Pages[id].prevPage) {\r\n      return V.Pages[id].prevPage;\r\n    } else {\r\n      const index = pageNavigationOrder.indexOf(id);\r\n\r\n      if (index === -1) {\r\n        console.error(`The page #${id} was not found in \\`pageNavigationOrder\\`.`);\r\n      } else if (index > 0) {\r\n        return pageNavigationOrder[index - 1];\r\n      } else {\r\n        // first page\r\n        console.warn(`\\`#${id}\\` is the first page.`)\r\n        return false;\r\n      } \r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  function showGate() {\r\n    body.classList.add('-show-gate');\r\n    document.addEventListener('keydown', gateKeydown);\r\n  }\r\n\r\n  function hideGate() {\r\n    body.classList.remove('-show-gate');\r\n    document.removeEventListener('keydown', gateKeydown);\r\n  }\r\n\r\n  /**\r\n   * Checks if there is a closed gate. \r\n   * If `V.Pages[id].onGate` exists and returns `true`, the gate is opened.\r\n   * \r\n   * @return {Boolean} - is the gate closed?\r\n   */\r\n  function isGateClosed() {\r\n    if (\r\n      !V.Pages[currentPageId].hasGate \r\n      && !(currentParentId && V.Pages[currentParentId].hasGate)\r\n    ) {\r\n      // there is no gate\r\n      return false;\r\n    }\r\n\r\n    if (V.SCORM.getCompleted(currentPageId)) {\r\n      // page is completed\r\n      return false;\r\n    }\r\n\r\n    if (V.Menu && V.Menu.isUnlocked()) {\r\n      // menu is unlocked\r\n      return false;\r\n    }\r\n\r\n    if (V.Pages[currentPageId].onGate && V.Pages[currentPageId].onGate()) {\r\n      // `onGate()` just opened the gate\r\n      return false;\r\n    } else {\r\n      console.info('`V.Pages.'+currentPageId+'.onGate()` returned false.');\r\n    }\r\n\r\n    // we got this far, so the gate is locked\r\n    console.info('Page has not been completed.');\r\n    showGate();\r\n\r\n    return true;\r\n  }\r\n\r\n  function setGateText(text) {\r\n    gateText.innerHTML = text;\r\n  }\r\n\r\n  function openGate(id) {\r\n    // if `id` parameter undefined, use `currentPageId`\r\n    id = id || currentPageId;\r\n    V.SCORM.setCompleted(id);\r\n    body.classList.remove('-next-disabled');\r\n  }\r\n\r\n  function gateKeydown(event) {\r\n    // enter, spacebar, or escape\r\n    if (event.keyCode == 13 || event.keyCode == 32 || event.keyCode == 27) {\r\n      event.preventDefault();\r\n      hideGate();\r\n\r\n      // don't let spacebar scroll the window\r\n      event.stopPropagation();\r\n    }\r\n  }\r\n\r\n  var blinkTL = new TimelineMax({paused: true, repeat: -1,});\r\n  var nextArrow = document.querySelectorAll('.arrows__arrow--next');\r\n  var blinkSpeed = 0.1;\r\n\r\n  blinkTL.add(\r\n    TweenLite.to(\r\n      nextArrow,\r\n      blinkSpeed,\r\n      {\r\n        opacity: 1,\r\n        ease: Sine.easeInOut\r\n      }\r\n    )\r\n  );\r\n\r\n  blinkTL.add(\r\n    TweenLite.to(\r\n      nextArrow,\r\n      blinkSpeed,\r\n      {\r\n        opacity: 0.1,\r\n        ease: Sine.easeInOut\r\n      }\r\n    )\r\n    , '+=' + blinkSpeed*4\r\n  );\r\n\r\n  blinkTL.add(\r\n    TweenLite.set({},{})\r\n    , '+=' + blinkSpeed*4\r\n  )\r\n\r\n  stopBlink();\r\n\r\n  function blink() {\r\n    blinkTL.play();\r\n  }\r\n\r\n  function stopBlink() {\r\n    blinkTL.pause();\r\n    TweenLite.set(nextArrow, {clearProps: 'all'});\r\n  }\r\n\r\n  /**\r\n   * Closes menu and gate.\r\n   */\r\n  function closePeripherals() {\r\n    if (V.Menu) {\r\n      V.Menu.close();\r\n    }\r\n\r\n    hideGate();\r\n    stopBlink();\r\n  }\r\n\r\n  function playAudio(audioId) {\r\n    if (!audioEnabled) {\r\n      return false;\r\n    }\r\n\r\n    // is this audio already playing?\r\n    if (audioNowPlaying && audioId === audioNowPlaying) {\r\n      resumeAudio();\r\n      return true;\r\n    }\r\n\r\n    stopAudio();\r\n\r\n    // don't play in hidden browser tab\r\n    if (typeof document.hidden === 'boolean' && document.hidden) {\r\n      return false;\r\n    }\r\n\r\n    // audio not a string with some length\r\n    if (typeof audioId !== 'string' || audioId.length === 0) {\r\n      return false;\r\n    }\r\n\r\n    if (!isMuted) {\r\n      getAudio(audioId);\r\n      audioNowPlaying = audioId;\r\n\r\n      audioTimeout = setTimeout(function () {\r\n        if(!audioNowPlaying) {\r\n          console.log('canceled audio');\r\n          return false;\r\n        } else {\r\n          var file = audioFiles[audioNowPlaying];\r\n    \r\n          if (!isMuted) {\r\n            // reset volume and time in case audio was stopped\r\n            TweenLite.set(file, {volume: 1, overwrite: 'all'});\r\n            file.currentTime = 0;\r\n            file.play();\r\n          }\r\n        }\r\n      }, 600);\r\n    } else {\r\n      // remember audio in case we unmute\r\n      audioNowPlaying = audioId;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Returns audio element saved in closured object. If the audio\r\n   * is not saved, loads it as `new Audio()`.\r\n   */\r\n  function getAudio(audioId) {\r\n    if (!audioEnabled) {\r\n      return false;\r\n    }\r\n\r\n    var file;\r\n\r\n    if (audioFiles[audioId]){\r\n      // the file is saved\r\n      file = audioFiles[audioId];\r\n    } else {\r\n      // load the file\r\n      if (isMuted) {\r\n        return false;\r\n      }\r\n\r\n      var filePath = 'audio/' + audioId;\r\n    \r\n      // '.mp3' extension is optional\r\n      if (filePath.substr(-4) !== '.mp3') {\r\n        filePath += '.mp3';\r\n      }\r\n    \r\n      file = new Audio(filePath);\r\n      audioFiles[audioId] = file;\r\n    } \r\n\r\n    return file;\r\n  }\r\n\r\n  function pauseAudio(trDur) {\r\n    if (!audioEnabled) {\r\n      return false;\r\n    }\r\n\r\n    if (typeof trDur !== 'number') {\r\n      trDur = 0.8;\r\n    }\r\n\r\n    var file = audioFiles[audioNowPlaying];\r\n\r\n    if (file) {\r\n      // tween volume from 1 to 0\r\n      TweenLite.to(\r\n        file, \r\n        trDur, \r\n        {\r\n          volume: 0,\r\n          onComplete: function () {\r\n            file.pause();\r\n          },\r\n          ease: 'audioEaseOut',\r\n          overwrite: 'all'\r\n        }\r\n      );\r\n    }\r\n  }\r\n\r\n  function stopAudio(trDur) {\r\n    if (!audioEnabled || !audioFiles) {\r\n      return false;\r\n    }\r\n\r\n    if (typeof trDur !== 'number') {\r\n      trDur = 0.8;\r\n    }\r\n\r\n    var file = audioFiles[audioNowPlaying];\r\n\r\n    if (file && !file.paused && file.currentTime) {\r\n      // tween volume from 1 to 0\r\n      TweenLite.to(\r\n        file, \r\n        trDur, \r\n        {\r\n          volume: 0,\r\n          onComplete: function () {\r\n            file.pause();\r\n\r\n            if (file.currentTime) {\r\n              file.currentTime = 0;\r\n            }\r\n          },\r\n          ease: 'audioEaseOut',\r\n          overwrite: 'all'\r\n        }\r\n      );\r\n    }\r\n\r\n    audioNowPlaying = false;\r\n  }\r\n\r\n  function resumeAudio() {\r\n    if (!audioEnabled) {\r\n      return false;\r\n    }\r\n\r\n    if (audioNowPlaying) {     \r\n      var file = getAudio(audioNowPlaying);\r\n\r\n      if (file.ended) {\r\n        // it finished playing\r\n        return false;\r\n      }\r\n\r\n      if (!file.paused && file.currentTime) {\r\n        // it's already playing\r\n        console.warn('The file ' + audioNowPlaying + ' is already playing.');\r\n\r\n        return false;\r\n      }\r\n\r\n      // back up 1 second\r\n      var currentTime = file.currentTime;\r\n      if (currentTime > 1.5) {\r\n        file.currentTime = currentTime - 1.5;\r\n      } else if (file.currentTime) {\r\n        file.currentTime = 0;\r\n      }\r\n\r\n      // tween volume from 0 to 1\r\n      if (!isMuted) {        \r\n        file.play();\r\n        TweenLite.to(\r\n          file, \r\n          0.5, \r\n          {\r\n            volume: 1,\r\n            ease: Expo.easeIn,\r\n            overwrite: 'all'\r\n          }\r\n        );\r\n      }\r\n    }\r\n  }\r\n\r\n  function muteAudio() {\r\n    if (!audioEnabled) {\r\n      return false;\r\n    }\r\n\r\n    isMuted = true; //\r\n    V.SCORM.set('mute', true);\r\n\r\n    if (audioNowPlaying) {\r\n      pauseAudio();\r\n    }\r\n  }\r\n\r\n  function unmuteAudio() {\r\n    if (!audioEnabled) {\r\n      return false;\r\n    }\r\n\r\n    isMuted = false;\r\n    V.SCORM.set('mute', false);\r\n\r\n    if (audioNowPlaying) {\r\n      resumeAudio();\r\n    }\r\n  }\r\n\r\n  function disableAudio() {\r\n    document.body.classList.add('-audio-disabled');\r\n    stopAudio();\r\n    audioEnabled = false;\r\n  }\r\n\r\n  function enableAudio() {\r\n    if (window.matchMedia('(min-width: 50em)').matches && V.Project.config.hasAudio) {\r\n      document.body.classList.remove('-audio-disabled');\r\n      audioEnabled = true;\r\n\r\n      return true;\r\n    }\r\n    \r\n    return false;\r\n  }\r\n\r\n  function initMuteButton() {\r\n    // mute button    \r\n    const muteButton = document.getElementById('mute-button');\r\n\r\n    if (muteButton && audioEnabled){\r\n      if (isMuted) {\r\n        // set button class now\r\n        muteButton.classList.add('-is-muted');\r\n      }\r\n\r\n      // add listener  \r\n      muteButton.addEventListener('click', function () {\r\n        if (isMuted) {\r\n          muteButton.classList.remove('-is-muted');\r\n          unmuteAudio();\r\n        } else {\r\n          muteButton.classList.add('-is-muted');\r\n          muteAudio();\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  function initNavigateOnKeydown() {\r\n    // keydown listeners \r\n    const throttledNext = _.throttle(next, 300);\r\n    const throttledPrev = _.throttle(prev, 300);\r\n\r\n    document.addEventListener('keydown', navigateOnKeydown);\r\n\r\n    function navigateOnKeydown(event) {\r\n      if (_.isUserTyping(event)) {\r\n        return false;\r\n      }\r\n\r\n      // right key for next\r\n      if (event.keyCode == 39) {\r\n        throttledNext();\r\n      }\r\n\r\n      // left key for prev\r\n      if (event.keyCode == 37) {\r\n        throttledPrev();\r\n      }\r\n\r\n      if (!V.SCORM.isConnected()) {\r\n        // U key to unlock\r\n        if (event.keyCode == 85) {\r\n          if (V.Menu) {\r\n            V.Menu.unlock();\r\n          }\r\n        }   \r\n\r\n        // L to open V.SCORM.log()\r\n        if (event.keyCode == 76) {\r\n          window.open(V.SCORM.log());\r\n        }\r\n      }\r\n    }\r\n  }\r\n})(window.V);\r\n"]}