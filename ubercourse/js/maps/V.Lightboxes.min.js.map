{"version":3,"sources":["V.Lightboxes.js"],"names":["initLightboxes","V","defaults","close","closeOpenLightbox","cancel","next","Navigation","Lightboxes","open","openLightbox","noOpenLightboxes","id","options","lightbox","document","getElementById","closeThisLightbox","forEach","fn","console","error","audio","getAttribute","lightboxBox","findChild","lightboxOverlay","onclick","SCORM","getViewed","setViewed","lock","closePeripherals","Audio","stop","play","body","classList","add","TweenLite","fromTo","autoAlpha","ease","Power0","easeNone","display","overwrite","y","Power2","easeOut","_","hasClass","addCloseOnClick","addEventListener","lightboxKeydown","event","keyCode","clickHighestPriorityButton","isUserTyping","stopPropagation","preventDefault","click","unlock","remove","to","removeEventListener","selector","querySelector","el","removeCloseOnClick","warn","window"],"mappings":";;;;;;;;;;GAIA,CAAC,CAAC,QAASA,eAAT,CAAwBC,CAAxB,CAA2B,CAC3B,GAAMC,UAAW,CACfC,MAAO,gBAAY,CACjBC,oBACD,CAHc,CAKfC,OAAQ,iBAAY,CAClBD,oBACD,CAPc,CASfE,KAAM,eAAY,CAChBF,oBACAH,EAAEM,UAAF,CAAaD,IAAb,GACD,CAZc,CAAjB,CAeAL,EAAEO,UAAF,CAAe,CACbC,KAAMC,YADO,CAEbP,MAAOD,SAASC,KAFH,CAGbG,KAAMJ,SAASI,IAHF,CAIbD,OAAQH,SAASG,MAJJ,CAAf,CAOA,GAAID,mBAAoBO,gBAAxB,CAEA,QAASD,aAAT,CAAsBE,EAAtB,CAA0BC,OAA1B,CAAmC,CACjC,GAAMC,UAAWC,SAASC,cAAT,CAAwBJ,EAAxB,CAAjB,CACAC,QAAUA,SAAW,EAArB,CACAT,kBAAqBa,iBAArB,CAGA,CAAC,OAAD,CAAU,MAAV,CAAkB,QAAlB,EAA4BC,OAA5B,CAAoC,SAAUC,EAAV,CAAc,CAChDlB,EAAEO,UAAF,CAAaW,EAAb,EAAqB,MAAON,SAAQM,EAAR,CAAP,GAAwB,UAAzB,CAChB,UAAY,CACVN,QAAQM,EAAR,IACAjB,SAASiB,EAAT,IACD,CAJe,CAKhBjB,SAASiB,EAAT,CALJ,CAMD,CAPD,EAUA,GAAI,CAACL,QAAL,CAAe,CACbM,QAAQC,KAAR,CAAc,+BAAiCT,EAAjC,CAAsC,IAApD,EACA,MAAO,MAAP,CACD,CAED,GAAIU,OAAQR,SAASS,YAAT,CAAsB,YAAtB,CAAZ,CAEA,GAAIC,aAAcC,UAAU,gBAAV,CAAlB,CACA,GAAIC,iBAAkBD,UAAU,oBAAV,CAAtB,CAGAA,UAAU,yBAAV,EAAqCE,OAArC,CAA+C1B,EAAEO,UAAF,CAAaL,KAA5D,CAGA,GAAIW,SAASS,YAAT,CAAsB,oBAAtB,CAAJ,CAAiD,CAC/C,GAAItB,EAAE2B,KAAF,CAAQC,SAAR,CAAkBjB,EAAlB,CAAJ,CAA2B,CAEzB,MAAO,MAAP,CACD,CAHD,IAGO,CAELX,EAAE2B,KAAF,CAAQE,SAAR,CAAkBlB,EAAlB,EACD,CACF,CAGDX,EAAEM,UAAF,CAAawB,IAAb,GAGA9B,EAAEM,UAAF,CAAayB,gBAAb,GAGA/B,EAAEgC,KAAF,CAAQC,IAAR,GAGA,GAAIZ,KAAJ,CAAW,CACTrB,EAAEgC,KAAF,CAAQE,IAAR,CAAab,KAAb,EACD,CAIDP,SAASqB,IAAT,CAAcC,SAAd,CAAwBC,GAAxB,CAA4B,cAA5B,EAGAC,UAAUC,MAAV,CACEd,eADF,CAEE,GAFF,CAGE,CACEe,UAAW,CADb,CAHF,CAME,CACEA,UAAW,CADb,CAEEC,KAAMC,OAAOC,QAFf,CANF,EAaAL,UAAUC,MAAV,CACE1B,QADF,CAEE,GAFF,CAGE,CACE2B,UAAW,CADb,CAHF,CAME,CACEA,UAAW,CADb,CAEEI,QAAS,MAFX,CAGEC,UAAW,KAHb,CAIEJ,KAAMC,OAAOC,QAJf,CANF,EAcAL,UAAUC,MAAV,CACEhB,WADF,CAEE,GAFF,CAGE,CACEiB,UAAW,CADb,CAEEM,EAAG,KAFL,CAHF,CAOE,CACEN,UAAW,CADb,CAEEM,EAAG,IAFL,CAGEF,QAAS,OAHX,CAIEC,UAAW,KAJb,CAKEJ,KAAMM,OAAOC,OALf,CAPF,EAiBA,GAAIC,EAAEC,QAAF,CAAWrC,QAAX,CAAqB,mBAArB,CAAJ,CAA+C,CAC7CsC,gBAAgB,oBAAhB,EACD,CAGDrC,SAASsC,gBAAT,CAA0B,SAA1B,CAAqCC,eAArC,EAGA,QAASA,gBAAT,CAAyBC,KAAzB,CAAgC,CAE9B,GAAIA,MAAMC,OAAN,EAAiB,EAArB,CAAyB,CACvBC,6BACD,CAGD,GAAIF,MAAMC,OAAN,EAAiB,EAArB,CAAyB,CAEvB,GAAIN,EAAEQ,YAAF,CAAeH,KAAf,CAAJ,CAA2B,CACzB,MAAO,MAAP,CACD,CAEDE,6BAGAF,MAAMI,eAAN,GACAJ,MAAMK,cAAN,GACD,CAGD,GACEL,MAAMC,OAAN,EAAiB,EAAjB,EACGN,EAAEC,QAAF,CAAWrC,QAAX,CAAqB,mBAArB,CAFL,CAGE,CACAG,oBACD,CACF,CAED,QAASwC,2BAAT,EAAsC,CACpC,GAAIhC,UAAU,yBAAV,CAAJ,CAA0C,CACxCA,UAAU,yBAAV,EAAqCoC,KAArC,GACD,CAFD,IAEO,IAAIpC,UAAU,0BAAV,CAAJ,CAA2C,CAChDA,UAAU,0BAAV,EAAsCoC,KAAtC,GACD,CAFM,IAEA,IAAIpC,UAAU,mBAAV,CAAJ,CAAoC,CACzCA,UAAU,mBAAV,EAA+BoC,KAA/B,GACD,CACF,CAGD,QAAS5C,kBAAT,EAA6B,CAC3BhB,EAAEM,UAAF,CAAauD,MAAb,GAEA,GAAIxC,KAAJ,CAAW,CACTrB,EAAEgC,KAAF,CAAQC,IAAR,CAAa,CAAb,EACD,CAGDnB,SAASqB,IAAT,CAAcC,SAAd,CAAwB0B,MAAxB,CAA+B,cAA/B,EAGAxB,UAAUyB,EAAV,CACElD,QADF,CAEE,GAFF,CAGE,CACE2B,UAAW,CADb,CAEEI,QAAS,MAFX,CAGEC,UAAW,KAHb,CAHF,EAWA/B,SAASkD,mBAAT,CAA6B,SAA7B,CAAwCX,eAAxC,EAGAlD,kBAAoBO,gBAApB,CACD,CAED,QAASc,UAAT,CAAmByC,QAAnB,CAA6B,CAC3B,MAAOpD,UAASqD,aAAT,CAAuBD,QAAvB,CAAP,CACD,CAED,QAASd,gBAAT,CAAyBc,QAAzB,CAAmC,CACjC,GAAIE,IAAKtD,SAASqD,aAAT,CAAuBD,QAAvB,CAAT,CAEA,GAAIE,EAAJ,CAAQ,CACNA,GAAGf,gBAAH,CAAoB,OAApB,CAA6BpC,iBAA7B,EACD,CACF,CAED,QAASoD,mBAAT,CAA4BH,QAA5B,CAAsC,CACpC,GAAIE,IAAKtD,SAASqD,aAAT,CAAuBD,QAAvB,CAAT,CAEA,GAAIE,EAAJ,CAAQ,CACNA,GAAGH,mBAAH,CAAuB,OAAvB,CAAgChD,iBAAhC,EACD,CACF,CACF,CAED,QAASN,iBAAT,EAA4B,CAC1BS,QAAQkD,IAAR,CAAa,qBAAb,EACD,CACF,CApOA,EAoOEC,OAAOtE,CApOT","file":"../V.Lightboxes.min.js","sourcesContent":["// ====================================\r\n//   Lightboxes\r\n// ====================================\r\n\r\n;(function initLightboxes(V) {\r\n  const defaults = {\r\n    close: function () {\r\n      closeOpenLightbox();\r\n    },\r\n\r\n    cancel: function () {\r\n      closeOpenLightbox();\r\n    },\r\n\r\n    next: function () {\r\n      closeOpenLightbox();\r\n      V.Navigation.next();\r\n    }\r\n  };\r\n\r\n  V.Lightboxes = {\r\n    open: openLightbox,\r\n    close: defaults.close,\r\n    next: defaults.next,\r\n    cancel: defaults.cancel\r\n  };\r\n\r\n  let closeOpenLightbox = noOpenLightboxes;  \r\n\r\n  function openLightbox(id, options) {\r\n    const lightbox = document.getElementById(id);\r\n    options = options || {};\r\n    closeOpenLightbox =  closeThisLightbox;\r\n\r\n    // set all callbacks\r\n    ['close', 'next', 'cancel'].forEach(function (fn) {\r\n      V.Lightboxes[fn]  = (typeof options[fn]  === 'function') \r\n        ? function () {\r\n            options[fn]();  \r\n            defaults[fn]();\r\n          }  \r\n        : defaults[fn];\r\n    })\r\n\r\n    // validate its existence\r\n    if (!lightbox) {\r\n      console.error('No lightbox exists with id \"' + id + '\".');\r\n      return false;\r\n    }\r\n    \r\n    var audio = lightbox.getAttribute('data-audio');\r\n \r\n    var lightboxBox = findChild('.lightbox__box');\r\n    var lightboxOverlay = findChild('.lightbox__overlay');\r\n\r\n    // add onclick to close button\r\n    findChild('.lightbox__close-button').onclick = V.Lightboxes.close;\r\n\r\n    // is this a view-once lightbox?\r\n    if (lightbox.getAttribute('data-is-shown-once')) {\r\n      if (V.SCORM.getViewed(id)) {\r\n        // already viewd, abort\r\n        return false;\r\n      } else {\r\n        // save view to SCORM\r\n        V.SCORM.setViewed(id);\r\n      }\r\n    }\r\n\r\n    // lock navigation\r\n    V.Navigation.lock();\r\n\r\n    // Hide peripherals\r\n    V.Navigation.closePeripherals();\r\n\r\n    // Stop audio\r\n    V.Audio.stop();\r\n\r\n    // if there is audio, play it\r\n    if (audio) {\r\n      V.Audio.play(audio);\r\n    }\r\n\r\n\r\n    // CSS states\r\n    document.body.classList.add('-is-overlaid');\r\n\r\n    // Open the lightbox\r\n    TweenLite.fromTo(\r\n      lightboxOverlay,\r\n      0.4,\r\n      {\r\n        autoAlpha: 0\r\n      },\r\n      {\r\n        autoAlpha: 1,\r\n        ease: Power0.easeNone\r\n      }\r\n    );\r\n\r\n    // Open the lightbox\r\n    TweenLite.fromTo(\r\n      lightbox,\r\n      0.2,\r\n      {\r\n        autoAlpha: 0\r\n      },\r\n      {\r\n        autoAlpha: 1,\r\n        display: 'flex',\r\n        overwrite: 'all',\r\n        ease: Power0.easeNone\r\n      }\r\n    );\r\n\r\n    TweenLite.fromTo(\r\n      lightboxBox,\r\n      0.6,\r\n      {\r\n        autoAlpha: 1,\r\n        y: '20%'\r\n      },\r\n      {\r\n        autoAlpha: 1,\r\n        y: '0%',\r\n        display: 'block',\r\n        overwrite: 'all',\r\n        ease: Power2.easeOut\r\n      }\r\n    );\r\n\r\n    // clickable overlay\r\n    if (_.hasClass(lightbox, '-has-close-button')) {\r\n      addCloseOnClick('.lightbox__overlay');\r\n    }\r\n\r\n    // keydown event listener\r\n    document.addEventListener('keydown', lightboxKeydown);\r\n\r\n    // keydown event\r\n    function lightboxKeydown(event) {\r\n      // enter\r\n      if (event.keyCode == 13) {\r\n        clickHighestPriorityButton();\r\n      } \r\n\r\n      // spacebar\r\n      if (event.keyCode == 32) {\r\n        // if typing in an input, cancel \r\n        if (_.isUserTyping(event)) {\r\n          return false;\r\n        }\r\n        \r\n        clickHighestPriorityButton();\r\n\r\n        // prevent default so spacebar won't scroll the window\r\n        event.stopPropagation();\r\n        event.preventDefault();\r\n      }\r\n\r\n      // escape key, but only if there's a close button\r\n      if (\r\n        event.keyCode == 27\r\n        && _.hasClass(lightbox, '-has-close-button')\r\n      ) {\r\n        closeThisLightbox();\r\n      }\r\n    }\r\n\r\n    function clickHighestPriorityButton() {\r\n      if (findChild('.lightbox__button--next')) {\r\n        findChild('.lightbox__button--next').click();\r\n      } else if (findChild('.lightbox__button--close')) {\r\n        findChild('.lightbox__button--close').click();\r\n      } else if (findChild('.lightbox__button')) {\r\n        findChild('.lightbox__button').click();\r\n      }\r\n    }\r\n\r\n    // close lightbox\r\n    function closeThisLightbox() {\r\n      V.Navigation.unlock();\r\n\r\n      if (audio) {\r\n        V.Audio.stop(2);\r\n      }\r\n\r\n      // remove styles\r\n      document.body.classList.remove('-is-overlaid');\r\n\r\n      // close the lightbox\r\n      TweenLite.to(\r\n        lightbox,\r\n        0.2,\r\n        {\r\n          autoAlpha: 0,\r\n          display: 'none',\r\n          overwrite: 'all',\r\n        }\r\n      );\r\n\r\n      // remove listener\r\n      document.removeEventListener('keydown', lightboxKeydown);\r\n\r\n      // clear close function\r\n      closeOpenLightbox = noOpenLightboxes;\r\n    }\r\n\r\n    function findChild(selector) {\r\n      return lightbox.querySelector(selector);\r\n    }\r\n\r\n    function addCloseOnClick(selector) {\r\n      var el = lightbox.querySelector(selector);\r\n\r\n      if (el) {\r\n        el.addEventListener('click', closeThisLightbox);\r\n      }\r\n    }\r\n\r\n    function removeCloseOnClick(selector) {\r\n      var el = lightbox.querySelector(selector);\r\n\r\n      if (el) {\r\n        el.removeEventListener('click', closeThisLightbox);\r\n      }\r\n    }\r\n  }\r\n\r\n  function noOpenLightboxes() {\r\n    console.warn('No open lightboxes.');\r\n  }\r\n})(window.V);\r\n"]}