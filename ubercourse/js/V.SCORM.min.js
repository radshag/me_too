/**
 * V.SCORM.js
 * Ubercourse v0.15.0
 * 
 * VinciWorks
 * https://vinciworks.com/
 * Copyright (c) 2017-2018 VinciWorks, All Rights Reserved.
 * 
 * Updated: Tue, 06 Mar 2018 14:03:46 GMT
 * 
 */window.V={};;(function initSCORM(V){V.SCORM={get:get,set:set,clearSuspendData:clearSuspendData,setViewed:setViewed,getViewed:getViewed,setCompleted:setCompleted,getCompleted:getCompleted,setLocation:setLocation,getLocation:getLocation,setScore:setScore,getScore:getScore,addToScore:addToScore,passed:passed,failed:failed,getLessonStatus:getLessonStatus,setLessonStatus:setLessonStatus,getFirm:getFirm,isFirm:isFirm,log:log,isConnected:isConnected,quit:pipwerks.SCORM.quit,save:pipwerks.SCORM.save};var pw=pipwerks.SCORM;pw.version="1.2";var initSuccess;var initAttempts=3;while(initAttempts--){try{initSuccess=pw.init();}catch(e){}if(initSuccess){initAttempts=0;}}var connected=pw.connection.isActive;function isConnected(){return connected;}V.SCORM.connected=connected;if(connected){V.SCORM.firstName=pw.get('cmi.core.student_name').split(",")[1];V.SCORM.lastName=pw.get('cmi.core.student_name').split(",")[0];V.SCORM.userName=pw.get('cmi.core.student_id');}else{V.SCORM.firstName='Demo';V.SCORM.lastName='User';V.SCORM.userName='demo_user';}var isDemo=V.SCORM.userName==='MASTERDEMO'||V.SCORM.userName==='MASTERANONYMOUS';if(isDemo){pw.set=function(){return false;};pw.save=function(){return false;};}var suspendString='';var suspendObject={};var suspendPairs={};initSuspendObject();var score=parseInt(connected?pw.get('cmi.core.score.raw')||0:getURLParameter('score')||0);function setScore(n){score=n;pw.set('cmi.core.score.raw',score);pw.save();}function getScore(){return score;}function addToScore(n){score+=n;pw.set('cmi.core.score.raw',score);pw.save();}if(!score&&score!==0){setScore(0);}function get(name){if(typeof name==='undefined'){return suspendObject;}if(suspendPairs[name]){return suspendPairs[name];}var levelNames=name.split('.');var value=suspendObject;for(var i=0,length=levelNames.length;i<length;i++){if(value.hasOwnProperty(levelNames[i])){value=value[levelNames[i]];}else{return void 0;}}return value;}function set(name,value,dontSave){if(suspendPairs[name]){suspendPairs[name]=value;}else{var levelNames=name.split('.');var level=suspendObject;for(var i=0,length=levelNames.length;i<length;i++){if(i+1<length){level[levelNames[i]]=level[levelNames[i]]||{};level=level[levelNames[i]];}else{level[levelNames[i]]=value;}}}if(!dontSave){saveSuspendData();}return true;}function setViewed(id){var viewedPages=get('viewedPages')||[];if(viewedPages.indexOf(id)===-1){viewedPages.push(id);set('viewedPages',viewedPages);return true;}return false;}function getViewed(id){var viewedPages=get('viewedPages')||[];return viewedPages.indexOf(id)!==-1;}function setCompleted(id){var completedActivities=get('completedActivities')||[];completedActivities.push(id);set('completedActivities',completedActivities);}function getCompleted(id){var completedActivities=get('completedActivities')||[];return completedActivities.indexOf(id)!==-1;}var lessonLocation=connected?pw.get('cmi.core.lesson_location'):getURLParameter('p');if(isDemo){lessonLocation=false;}function setLocation(name){lessonLocation=name;pw.set('cmi.core.lesson_location',lessonLocation);pw.save();}function getLocation(){return lessonLocation;}function getPrevLocation(){var viewedPages=get('historyViewedPages');return viewedPages[viewedPages.length-2];}var lessonStatus=connected?pw.get('cmi.core.lesson_status'):'incomplete';function setLessonStatus(status){lessonStatus=status;pw.set('cmi.core.lesson_status',lessonStatus);pw.save();}function getLessonStatus(){return lessonStatus;}function passed(){setLessonStatus('passed');}function failed(){setLessonStatus('failed');}function getFirm(){return get('Var_firm_name').toUpperCase();}function isFirm(firm){return firm.toUpperCase()===get('Var_firm_name').toUpperCase();}window.addEventListener('beforeunload',setExit);window.addEventListener('unload',setExit);function setExit(){var exit=lessonStatus==='incomplete'?'suspend':'logout';pw.set('cmi.core.exit',exit);pw.save();}function log(){return window.location.origin+'/app.html?p='+lessonLocation+'&sd='+encodeURIComponent(suspendString)+'&score='+score;}document.addEventListener("DOMContentLoaded",function saveClicksOnReady(){setTimeout(saveClicks,0);});function initSuspendObject(){if(connected){suspendString=pw.get('cmi.suspend_data');}else if(getURLParameter('sd')){suspendString=getURLParameter('sd');}if(suspendString.indexOf('Varpassmark')===-1){if(typeof getDefaultSuspendData==='function'){suspendString+=getDefaultSuspendData();}else{console.log('Missing scormextern.js.');}}console.log('Suspend Data: '+suspendString);var match=suspendString.match(/json=([^;]+);/);var JSONString=match?match[1]:'{}';suspendObject=JSON.parse(decodeURIComponent(JSONString));var pairs=suspendString.match(/([^=;]+)=([^=;]+);/g)||[];var pair;var i=pairs.length;while(i--){pair=pairs[i].slice(0,-1).split('=');if(pair[0]!=='json'){suspendPairs[pair[0]]=pair[1];}}return suspendObject;}function clearSuspendData(){suspendObject={};saveSuspendData();}function saveSuspendData(){var JSONString=JSON.stringify(suspendObject);JSONString=JSONString.replace(/;/g,'%3B');JSONString=JSONString.replace(/=/g,'%3D');var newString='json='+JSONString+';';Object.keys(suspendPairs).forEach(function(key){newString+=key+'='+suspendPairs[key]+';';});if(connected){setTimeout(function(){pw.set('cmi.suspend_data',newString);pw.save();},20);}suspendString=newString;V.SCORM.offlineSuspendData=newString;console.log('saveSuspendData()');return newString;}function getURLParameter(name){return decodeURIComponent((new RegExp('[?|&]'+name+'='+'([^&;]+?)(&|#|;|$)').exec(location.search)||[null,''])[1].replace(/\+/g,'%20'))||null;}function saveClicks(){var pages=document.getElementsByClassName('page');var pageID;var elements;var i,iMax,j,jMax;V.SCORM.isReenactingClicks=true;for(i=0,iMax=pages.length;i<iMax;i++){pageID=pages[i].id;elements=pages[i].getElementsByClassName('save-click');if(elements.length){if(!suspendObject.savedClicks){suspendObject.savedClicks={};}for(j=0,jMax=elements.length;j<jMax;j++){if(suspendObject.savedClicks[pageID]&&suspendObject.savedClicks[pageID][j]){elements[j].click();}elements[j].addEventListener('click',saveClick.bind(null,pageID,j));}}}V.SCORM.isReenactingClicks=false;function saveClick(pageID,j){if(!suspendObject.savedClicks[pageID]){suspendObject.savedClicks[pageID]=[];}suspendObject.savedClicks[pageID][j]=1;saveSuspendData();}}})(window.V);
//# sourceMappingURL=maps/V.SCORM.min.js.map
