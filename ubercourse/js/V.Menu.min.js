/**
 * V.Menu.js
 * Ubercourse v0.15.0
 * 
 * VinciWorks
 * https://vinciworks.com/
 * Copyright (c) 2017-2018 VinciWorks, All Rights Reserved.
 * 
 * Updated: Tue, 06 Mar 2018 14:03:46 GMT
 * 
 */;(function initMenu(V,document){V.Menu={build:buildMenu,close:closeMenu,getList:getMenuItemList,isUnlocked:isMenuUnlocked,render:renderMenu,unlock:unlockMenu};var body=document.body;var menuList=document.querySelector('.main-menu__list');var menuProgress=document.querySelector('.main-menu__progress-fill');document.querySelector('.main-menu__heading').textContent=V.Project.config.title;var menuItemList=void 0;var totalPages=void 0;var numberings=void 0;document.addEventListener('DOMContentLoaded',function menuOnDOMReady(){document.querySelector('.main-menu__button').onclick=function(){body.classList.toggle('-open-menu');};document.querySelector('.main-menu__close-button').onclick=closeMenu;document.querySelector('.main-menu__close-overlay').onclick=closeMenu;renderMenu();});function closeMenu(){body.classList.remove('-open-menu');}var isUnlocked=false;function isMenuUnlocked(){return isUnlocked;}function unlockMenu(){isUnlocked=true;renderMenu();return true;}function getMenuItemList(){return menuItemList;}function buildMenu(newMenuItemList,options){options=options||{};menuItemList=newMenuItemList;totalPages=newMenuItemList.length;numberings=[null,null,null];var newNumberings=options.numberings||[];for(var i=0,iMax=newNumberings.length;i<iMax;i++){numberings[i]=newNumberings[i];}renderMenu();if(options.setNavigation){var pageList=[];for(var _i=0,_iMax=menuItemList.length;_i<_iMax;_i++){var id=typeof menuItemList[_i]==='string'?menuItemList[_i]:menuItemList[_i].id;if(id){if(V.Pages[id].parent){if(pageList.length===0){pageList.push(V.Pages[id].parent);}else if(pageList[pageList.length-1]!==V.Pages[id].parent){pageList.push(V.Pages[id].parent);}}else{pageList.push(id);}}}V.Navigation.setOrder(pageList);}}function renderMenu(){if(!menuItemList){console.warn('No menu available to render.');return false;}var levelCount=[0,0,0];var unlocked=true;var output='';var viewedPages=0;var totalPages=menuItemList.length;for(var i=0;i<totalPages;i++){var item=typeof menuItemList[i]==='string'?{id:menuItemList[i]}:menuItemList[i];if(!item.hidden){var id=item.id;if(!id){var j=i;while(!id&&j<totalPages-1){j++;if(!menuItemList[j].hidden){id=typeof menuItemList[j]==='string'?menuItemList[j]:menuItemList[j].id;}}}viewedPages+=V.SCORM.getViewed(id);var pageChildren=V.Pages[id].children||false;var level=item.level||0;var title=item.title||id&&V.Pages[id].title||console.warn('Page #'+id+' is missing a title.');if(unlocked&&!V.SCORM.getViewed(id)&&!isMenuUnlocked()){unlocked=false;}var isCurrentPage=item.id&&V.SCORM.getLocation()===item.id||pageChildren&&pageChildren.indexOf(V.SCORM.getLocation())!==-1;var isAboveCurrentPage=!item.id&&V.SCORM.getLocation()===id;var className='main-menu__item';className+=!unlocked?' main-menu__item--locked':'';className+=level>0?' main-menu__item--level-'+level:'';className+=isCurrentPage?' main-menu__item--current':'';className+=isAboveCurrentPage?' main-menu__item--above-current':'';var onclick=unlocked&&!isCurrentPage&&!isAboveCurrentPage?'onclick="V.Navigation.go(\''+id+'\');"':'';if(level==2){levelCount[0]=0;levelCount[1]=0;levelCount[2]++;}else if(level==1){levelCount[0]=0;levelCount[1]++;}else{levelCount[0]++;}var numbering=numberings[2-level]||'';if(numbering){numbering=numbering.replace('{2}',levelCount[2]||1).replace('{1}',levelCount[1]||1).replace('{0}',levelCount[0]||1);}output+='<div class="'+className+'" '+onclick+' tabindex="0"><span class="main-menu__numbering-'+level+'">'+numbering+'</span> <span "main-menu__text-level-'+level+'">'+title+'</span></div>';}}menuList.innerHTML=output;var currentPage=document.querySelector('.main-menu__item--current');if(currentPage){menuList.scrollTop=currentPage.offsetTop-currentPage.offsetHeight-menuList.offsetHeight/2;}menuProgress.style.width=viewedPages/totalPages*100+'%';var menuLinks=document.querySelectorAll('.main-menu__page, .main-menu__part-title, .main-menu__module-title');var keydownMenuLink;var _loop=function _loop(length,_i2){(function menuLinkListeners(){var pageId=menuLinks[_i2].getAttribute('data-page-id');if(!pageId){return false;}menuLinks[_i2].addEventListener('click',followMenuLink.bind(null,pageId));menuLinks[_i2].addEventListener('keydown',function keydownMenuLink(e){console.log(e,pageId);if(e.keyCode==13){followMenuLink(pageId);}});})();};for(var _i2=0,length=menuLinks.length;_i2<length;_i2++){_loop(length,_i2);}}})(window.V,document);
//# sourceMappingURL=maps/V.Menu.min.js.map
